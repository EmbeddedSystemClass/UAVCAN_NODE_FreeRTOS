ARM GAS  /tmp/ccmkeNKF.s 			page 1


   1              		.cpu cortex-m3
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 1
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"canard_stm32.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.text.isFramePriorityHigher,"ax",%progbits
  16              		.align	1
  17              		.syntax unified
  18              		.thumb
  19              		.thumb_func
  20              		.fpu softvfp
  22              	isFramePriorityHigher:
  23              	.LFB1:
  24              		.file 1 "libcanard/drivers/stm32/canard_stm32.c"
   1:libcanard/drivers/stm32/canard_stm32.c **** /*
   2:libcanard/drivers/stm32/canard_stm32.c ****  * Copyright (c) 2017 UAVCAN Team
   3:libcanard/drivers/stm32/canard_stm32.c ****  *
   4:libcanard/drivers/stm32/canard_stm32.c ****  * Distributed under the MIT License, available in the file LICENSE.
   5:libcanard/drivers/stm32/canard_stm32.c ****  *
   6:libcanard/drivers/stm32/canard_stm32.c ****  * Author: Pavel Kirienko <pavel.kirienko@zubax.com>
   7:libcanard/drivers/stm32/canard_stm32.c ****  */
   8:libcanard/drivers/stm32/canard_stm32.c **** 
   9:libcanard/drivers/stm32/canard_stm32.c **** #include "canard_stm32.h"
  10:libcanard/drivers/stm32/canard_stm32.c **** #include "_internal_bxcan.h"
  11:libcanard/drivers/stm32/canard_stm32.c **** #include <unistd.h>
  12:libcanard/drivers/stm32/canard_stm32.c **** 
  13:libcanard/drivers/stm32/canard_stm32.c **** 
  14:libcanard/drivers/stm32/canard_stm32.c **** #if CANARD_STM32_USE_CAN2
  15:libcanard/drivers/stm32/canard_stm32.c **** # define BXCAN                                                  CANARD_STM32_CAN2
  16:libcanard/drivers/stm32/canard_stm32.c **** #else
  17:libcanard/drivers/stm32/canard_stm32.c **** # define BXCAN                                                  CANARD_STM32_CAN1
  18:libcanard/drivers/stm32/canard_stm32.c **** #endif
  19:libcanard/drivers/stm32/canard_stm32.c **** 
  20:libcanard/drivers/stm32/canard_stm32.c **** /*
  21:libcanard/drivers/stm32/canard_stm32.c ****  * State variables
  22:libcanard/drivers/stm32/canard_stm32.c ****  */
  23:libcanard/drivers/stm32/canard_stm32.c **** static CanardSTM32Stats g_stats;
  24:libcanard/drivers/stm32/canard_stm32.c **** 
  25:libcanard/drivers/stm32/canard_stm32.c **** static bool g_abort_tx_on_error = false;
  26:libcanard/drivers/stm32/canard_stm32.c **** 
  27:libcanard/drivers/stm32/canard_stm32.c **** 
  28:libcanard/drivers/stm32/canard_stm32.c **** static bool isFramePriorityHigher(uint32_t a, uint32_t b)
  29:libcanard/drivers/stm32/canard_stm32.c **** {
  25              		.loc 1 29 0
  26              		.cfi_startproc
  27              		@ args = 0, pretend = 0, frame = 0
  28              		@ frame_needed = 0, uses_anonymous_args = 0
  29              		@ link register save eliminated.
ARM GAS  /tmp/ccmkeNKF.s 			page 2


  30              	.LVL0:
  31 0000 30B4     		push	{r4, r5}
  32              	.LCFI0:
  33              		.cfi_def_cfa_offset 8
  34              		.cfi_offset 4, -8
  35              		.cfi_offset 5, -4
  30:libcanard/drivers/stm32/canard_stm32.c ****     const uint32_t clean_a = a & CANARD_CAN_EXT_ID_MASK;
  36              		.loc 1 30 0
  37 0002 20F06045 		bic	r5, r0, #-536870912
  38              	.LVL1:
  31:libcanard/drivers/stm32/canard_stm32.c ****     const uint32_t clean_b = b & CANARD_CAN_EXT_ID_MASK;
  39              		.loc 1 31 0
  40 0006 21F06044 		bic	r4, r1, #-536870912
  41              	.LVL2:
  32:libcanard/drivers/stm32/canard_stm32.c **** 
  33:libcanard/drivers/stm32/canard_stm32.c ****     /*
  34:libcanard/drivers/stm32/canard_stm32.c ****      * STD vs EXT - if 11 most significant bits are the same, EXT loses.
  35:libcanard/drivers/stm32/canard_stm32.c ****      */
  36:libcanard/drivers/stm32/canard_stm32.c ****     const bool ext_a = (a & CANARD_CAN_FRAME_EFF) != 0;
  37:libcanard/drivers/stm32/canard_stm32.c ****     const bool ext_b = (b & CANARD_CAN_FRAME_EFF) != 0;
  42              		.loc 1 37 0
  43 000a CB0F     		lsrs	r3, r1, #31
  44              	.LVL3:
  38:libcanard/drivers/stm32/canard_stm32.c ****     if (ext_a != ext_b)
  45              		.loc 1 38 0
  46 000c B3EBD07F 		cmp	r3, r0, lsr #31
  47 0010 0FD0     		beq	.L2
  48              	.LBB2:
  39:libcanard/drivers/stm32/canard_stm32.c ****     {
  40:libcanard/drivers/stm32/canard_stm32.c ****         const uint32_t arb11_a = ext_a ? (clean_a >> 18U) : clean_a;
  49              		.loc 1 40 0
  50 0012 0028     		cmp	r0, #0
  51 0014 09DB     		blt	.L10
  52              	.LVL4:
  53              	.L3:
  41:libcanard/drivers/stm32/canard_stm32.c ****         const uint32_t arb11_b = ext_b ? (clean_b >> 18U) : clean_b;
  54              		.loc 1 41 0 discriminator 4
  55 0016 0029     		cmp	r1, #0
  56 0018 09DB     		blt	.L11
  57              	.LVL5:
  58              	.L4:
  42:libcanard/drivers/stm32/canard_stm32.c ****         if (arb11_a != arb11_b)
  59              		.loc 1 42 0 discriminator 4
  60 001a A542     		cmp	r5, r4
  61 001c 18D0     		beq	.L7
  43:libcanard/drivers/stm32/canard_stm32.c ****         {
  44:libcanard/drivers/stm32/canard_stm32.c ****             return arb11_a < arb11_b;
  62              		.loc 1 44 0
  63 001e A542     		cmp	r5, r4
  64 0020 2CBF     		ite	cs
  65 0022 0020     		movcs	r0, #0
  66              	.LVL6:
  67 0024 0120     		movcc	r0, #1
  68              	.LVL7:
  69              	.L5:
  70              	.LBE2:
  45:libcanard/drivers/stm32/canard_stm32.c ****         }
ARM GAS  /tmp/ccmkeNKF.s 			page 3


  46:libcanard/drivers/stm32/canard_stm32.c ****         else
  47:libcanard/drivers/stm32/canard_stm32.c ****         {
  48:libcanard/drivers/stm32/canard_stm32.c ****             return ext_b;
  49:libcanard/drivers/stm32/canard_stm32.c ****         }
  50:libcanard/drivers/stm32/canard_stm32.c ****     }
  51:libcanard/drivers/stm32/canard_stm32.c **** 
  52:libcanard/drivers/stm32/canard_stm32.c ****     /*
  53:libcanard/drivers/stm32/canard_stm32.c ****      * RTR vs Data frame - if frame identifiers and frame types are the same, RTR loses.
  54:libcanard/drivers/stm32/canard_stm32.c ****      */
  55:libcanard/drivers/stm32/canard_stm32.c ****     const bool rtr_a = (a & CANARD_CAN_FRAME_RTR) != 0;
  56:libcanard/drivers/stm32/canard_stm32.c ****     const bool rtr_b = (b & CANARD_CAN_FRAME_RTR) != 0;
  57:libcanard/drivers/stm32/canard_stm32.c ****     if ((clean_a == clean_b) && (rtr_a != rtr_b))
  58:libcanard/drivers/stm32/canard_stm32.c ****     {
  59:libcanard/drivers/stm32/canard_stm32.c ****         return rtr_b;
  60:libcanard/drivers/stm32/canard_stm32.c ****     }
  61:libcanard/drivers/stm32/canard_stm32.c **** 
  62:libcanard/drivers/stm32/canard_stm32.c ****     /*
  63:libcanard/drivers/stm32/canard_stm32.c ****      * Plain ID arbitration - greater value loses.
  64:libcanard/drivers/stm32/canard_stm32.c ****      */
  65:libcanard/drivers/stm32/canard_stm32.c ****     return clean_a < clean_b;
  66:libcanard/drivers/stm32/canard_stm32.c **** }
  71              		.loc 1 66 0
  72 0026 30BC     		pop	{r4, r5}
  73              	.LCFI1:
  74              		.cfi_remember_state
  75              		.cfi_restore 5
  76              		.cfi_restore 4
  77              		.cfi_def_cfa_offset 0
  78 0028 7047     		bx	lr
  79              	.LVL8:
  80              	.L10:
  81              	.LCFI2:
  82              		.cfi_restore_state
  83              	.LBB3:
  40:libcanard/drivers/stm32/canard_stm32.c ****         const uint32_t arb11_b = ext_b ? (clean_b >> 18U) : clean_b;
  84              		.loc 1 40 0 discriminator 1
  85 002a AD0C     		lsrs	r5, r5, #18
  86              	.LVL9:
  87 002c F3E7     		b	.L3
  88              	.LVL10:
  89              	.L11:
  41:libcanard/drivers/stm32/canard_stm32.c ****         if (arb11_a != arb11_b)
  90              		.loc 1 41 0 discriminator 1
  91 002e A40C     		lsrs	r4, r4, #18
  92              	.LVL11:
  93 0030 F3E7     		b	.L4
  94              	.LVL12:
  95              	.L2:
  96              	.LBE3:
  55:libcanard/drivers/stm32/canard_stm32.c ****     const bool rtr_b = (b & CANARD_CAN_FRAME_RTR) != 0;
  97              		.loc 1 55 0
  98 0032 C0F38072 		ubfx	r2, r0, #30, #1
  99              	.LVL13:
  56:libcanard/drivers/stm32/canard_stm32.c ****     if ((clean_a == clean_b) && (rtr_a != rtr_b))
 100              		.loc 1 56 0
 101 0036 C1F38071 		ubfx	r1, r1, #30, #1
 102              	.LVL14:
ARM GAS  /tmp/ccmkeNKF.s 			page 4


  57:libcanard/drivers/stm32/canard_stm32.c ****     {
 103              		.loc 1 57 0
 104 003a A542     		cmp	r5, r4
 105 003c 04D0     		beq	.L12
 106              	.L6:
  65:libcanard/drivers/stm32/canard_stm32.c **** }
 107              		.loc 1 65 0
 108 003e A542     		cmp	r5, r4
 109 0040 2CBF     		ite	cs
 110 0042 0020     		movcs	r0, #0
 111              	.LVL15:
 112 0044 0120     		movcc	r0, #1
 113 0046 EEE7     		b	.L5
 114              	.LVL16:
 115              	.L12:
  57:libcanard/drivers/stm32/canard_stm32.c ****     {
 116              		.loc 1 57 0 discriminator 1
 117 0048 8A42     		cmp	r2, r1
 118 004a F8D0     		beq	.L6
  59:libcanard/drivers/stm32/canard_stm32.c ****     }
 119              		.loc 1 59 0
 120 004c 0846     		mov	r0, r1
 121              	.LVL17:
 122 004e EAE7     		b	.L5
 123              	.LVL18:
 124              	.L7:
 125              	.LBB4:
  48:libcanard/drivers/stm32/canard_stm32.c ****         }
 126              		.loc 1 48 0
 127 0050 1846     		mov	r0, r3
 128              	.LVL19:
 129 0052 E8E7     		b	.L5
 130              	.LBE4:
 131              		.cfi_endproc
 132              	.LFE1:
 134              		.section	.text.convertFrameIDCanardToRegister,"ax",%progbits
 135              		.align	1
 136              		.syntax unified
 137              		.thumb
 138              		.thumb_func
 139              		.fpu softvfp
 141              	convertFrameIDCanardToRegister:
 142              	.LFB2:
  67:libcanard/drivers/stm32/canard_stm32.c **** 
  68:libcanard/drivers/stm32/canard_stm32.c **** /// Converts libcanard ID value into the bxCAN TX ID register format.
  69:libcanard/drivers/stm32/canard_stm32.c **** static uint32_t convertFrameIDCanardToRegister(const uint32_t id)
  70:libcanard/drivers/stm32/canard_stm32.c **** {
 143              		.loc 1 70 0
 144              		.cfi_startproc
 145              		@ args = 0, pretend = 0, frame = 0
 146              		@ frame_needed = 0, uses_anonymous_args = 0
 147              		@ link register save eliminated.
 148              	.LVL20:
  71:libcanard/drivers/stm32/canard_stm32.c ****     uint32_t out = 0;
  72:libcanard/drivers/stm32/canard_stm32.c **** 
  73:libcanard/drivers/stm32/canard_stm32.c ****     if (id & CANARD_CAN_FRAME_EFF)
 149              		.loc 1 73 0
ARM GAS  /tmp/ccmkeNKF.s 			page 5


 150 0000 021E     		subs	r2, r0, #0
 151 0002 06DB     		blt	.L17
  74:libcanard/drivers/stm32/canard_stm32.c ****     {
  75:libcanard/drivers/stm32/canard_stm32.c ****         out = ((id & CANARD_CAN_EXT_ID_MASK) << 3U) | CANARD_STM32_CAN_TIR_IDE;
  76:libcanard/drivers/stm32/canard_stm32.c ****     }
  77:libcanard/drivers/stm32/canard_stm32.c ****     else
  78:libcanard/drivers/stm32/canard_stm32.c ****     {
  79:libcanard/drivers/stm32/canard_stm32.c ****         out = ((id & CANARD_CAN_STD_ID_MASK) << 21U);
 152              		.loc 1 79 0
 153 0004 5005     		lsls	r0, r2, #21
 154              	.LVL21:
 155              	.L15:
  80:libcanard/drivers/stm32/canard_stm32.c ****     }
  81:libcanard/drivers/stm32/canard_stm32.c **** 
  82:libcanard/drivers/stm32/canard_stm32.c ****     if (id & CANARD_CAN_FRAME_RTR)
 156              		.loc 1 82 0
 157 0006 12F0804F 		tst	r2, #1073741824
 158 000a 01D0     		beq	.L13
  83:libcanard/drivers/stm32/canard_stm32.c ****     {
  84:libcanard/drivers/stm32/canard_stm32.c ****         out |= CANARD_STM32_CAN_TIR_RTR;
 159              		.loc 1 84 0
 160 000c 40F00200 		orr	r0, r0, #2
 161              	.LVL22:
 162              	.L13:
  85:libcanard/drivers/stm32/canard_stm32.c ****     }
  86:libcanard/drivers/stm32/canard_stm32.c **** 
  87:libcanard/drivers/stm32/canard_stm32.c ****     return out;
  88:libcanard/drivers/stm32/canard_stm32.c **** }
 163              		.loc 1 88 0
 164 0010 7047     		bx	lr
 165              	.LVL23:
 166              	.L17:
  75:libcanard/drivers/stm32/canard_stm32.c ****     }
 167              		.loc 1 75 0
 168 0012 D300     		lsls	r3, r2, #3
 169 0014 43F00400 		orr	r0, r3, #4
 170              	.LVL24:
 171 0018 F5E7     		b	.L15
 172              		.cfi_endproc
 173              	.LFE2:
 175              		.section	.text.convertFrameIDRegisterToCanard,"ax",%progbits
 176              		.align	1
 177              		.syntax unified
 178              		.thumb
 179              		.thumb_func
 180              		.fpu softvfp
 182              	convertFrameIDRegisterToCanard:
 183              	.LFB3:
  89:libcanard/drivers/stm32/canard_stm32.c **** 
  90:libcanard/drivers/stm32/canard_stm32.c **** /// Converts bxCAN TX/RX (sic! both RX/TX are supported) ID register value into the libcanard ID fo
  91:libcanard/drivers/stm32/canard_stm32.c **** static uint32_t convertFrameIDRegisterToCanard(const uint32_t id)
  92:libcanard/drivers/stm32/canard_stm32.c **** {
 184              		.loc 1 92 0
 185              		.cfi_startproc
 186              		@ args = 0, pretend = 0, frame = 0
 187              		@ frame_needed = 0, uses_anonymous_args = 0
 188              		@ link register save eliminated.
ARM GAS  /tmp/ccmkeNKF.s 			page 6


 189              	.LVL25:
  93:libcanard/drivers/stm32/canard_stm32.c **** #if (CANARD_STM32_CAN_TIR_RTR != CANARD_STM32_CAN_RIR_RTR) ||\
  94:libcanard/drivers/stm32/canard_stm32.c ****     (CANARD_STM32_CAN_TIR_IDE != CANARD_STM32_CAN_RIR_IDE)
  95:libcanard/drivers/stm32/canard_stm32.c **** # error "RIR bits do not match TIR bits, TIR --> libcanard conversion is not possible"
  96:libcanard/drivers/stm32/canard_stm32.c **** #endif
  97:libcanard/drivers/stm32/canard_stm32.c **** 
  98:libcanard/drivers/stm32/canard_stm32.c ****     uint32_t out = 0;
  99:libcanard/drivers/stm32/canard_stm32.c **** 
 100:libcanard/drivers/stm32/canard_stm32.c ****     if ((id & CANARD_STM32_CAN_RIR_IDE) == 0)
 190              		.loc 1 100 0
 191 0000 10F0040F 		tst	r0, #4
 192 0004 07D1     		bne	.L19
 101:libcanard/drivers/stm32/canard_stm32.c ****     {
 102:libcanard/drivers/stm32/canard_stm32.c ****         out = (CANARD_CAN_STD_ID_MASK & (id >> 21U));
 193              		.loc 1 102 0
 194 0006 430D     		lsrs	r3, r0, #21
 195              	.LVL26:
 196              	.L20:
 103:libcanard/drivers/stm32/canard_stm32.c ****     }
 104:libcanard/drivers/stm32/canard_stm32.c ****     else
 105:libcanard/drivers/stm32/canard_stm32.c ****     {
 106:libcanard/drivers/stm32/canard_stm32.c ****         out = (CANARD_CAN_EXT_ID_MASK & (id >> 3U)) | CANARD_CAN_FRAME_EFF;
 107:libcanard/drivers/stm32/canard_stm32.c ****     }
 108:libcanard/drivers/stm32/canard_stm32.c **** 
 109:libcanard/drivers/stm32/canard_stm32.c ****     if ((id & CANARD_STM32_CAN_RIR_RTR) != 0)
 197              		.loc 1 109 0
 198 0008 10F0020F 		tst	r0, #2
 199 000c 01D0     		beq	.L18
 110:libcanard/drivers/stm32/canard_stm32.c ****     {
 111:libcanard/drivers/stm32/canard_stm32.c ****         out |= CANARD_CAN_FRAME_RTR;
 200              		.loc 1 111 0
 201 000e 43F08043 		orr	r3, r3, #1073741824
 202              	.LVL27:
 203              	.L18:
 112:libcanard/drivers/stm32/canard_stm32.c ****     }
 113:libcanard/drivers/stm32/canard_stm32.c **** 
 114:libcanard/drivers/stm32/canard_stm32.c ****     return out;
 115:libcanard/drivers/stm32/canard_stm32.c **** }
 204              		.loc 1 115 0
 205 0012 1846     		mov	r0, r3
 206              	.LVL28:
 207 0014 7047     		bx	lr
 208              	.LVL29:
 209              	.L19:
 106:libcanard/drivers/stm32/canard_stm32.c ****     }
 210              		.loc 1 106 0
 211 0016 C308     		lsrs	r3, r0, #3
 212 0018 43F00043 		orr	r3, r3, #-2147483648
 213              	.LVL30:
 214 001c F4E7     		b	.L20
 215              		.cfi_endproc
 216              	.LFE3:
 218              		.section	.text.waitMSRINAKBitStateChange,"ax",%progbits
 219              		.align	1
 220              		.syntax unified
 221              		.thumb
 222              		.thumb_func
ARM GAS  /tmp/ccmkeNKF.s 			page 7


 223              		.fpu softvfp
 225              	waitMSRINAKBitStateChange:
 226              	.LFB4:
 116:libcanard/drivers/stm32/canard_stm32.c **** 
 117:libcanard/drivers/stm32/canard_stm32.c **** 
 118:libcanard/drivers/stm32/canard_stm32.c **** static bool waitMSRINAKBitStateChange(volatile const CanardSTM32CANType* const bxcan, const bool ta
 119:libcanard/drivers/stm32/canard_stm32.c **** {
 227              		.loc 1 119 0
 228              		.cfi_startproc
 229              		@ args = 0, pretend = 0, frame = 0
 230              		@ frame_needed = 0, uses_anonymous_args = 0
 231              		@ link register save eliminated.
 232              	.LVL31:
 233              	.LBB5:
 120:libcanard/drivers/stm32/canard_stm32.c ****     /**
 121:libcanard/drivers/stm32/canard_stm32.c ****      * A properly functioning bus will exhibit 11 consecutive recessive bits at the end of every co
 122:libcanard/drivers/stm32/canard_stm32.c ****      * or while the bus is idle. The 11 consecutive recessive bits are made up of:
 123:libcanard/drivers/stm32/canard_stm32.c ****      *  1 bit - acknowledgement delimiter
 124:libcanard/drivers/stm32/canard_stm32.c ****      *  7 bit - end of frame bits
 125:libcanard/drivers/stm32/canard_stm32.c ****      *  3 bit - inter frame space
 126:libcanard/drivers/stm32/canard_stm32.c ****      * This adds up to 11; therefore, it is not really necessary to wait longer than a few frame TX
 127:libcanard/drivers/stm32/canard_stm32.c ****      */
 128:libcanard/drivers/stm32/canard_stm32.c ****     static const uint16_t TimeoutMilliseconds = 1000;
 129:libcanard/drivers/stm32/canard_stm32.c **** 
 130:libcanard/drivers/stm32/canard_stm32.c ****     for (uint16_t wait_ack = 0; wait_ack < TimeoutMilliseconds; wait_ack++)
 234              		.loc 1 130 0
 235 0000 0022     		movs	r2, #0
 236              	.LVL32:
 237              	.L23:
 238              		.loc 1 130 0 is_stmt 0 discriminator 1
 239 0002 B2F57A7F 		cmp	r2, #1000
 240 0006 08D2     		bcs	.L27
 241              	.LBB6:
 131:libcanard/drivers/stm32/canard_stm32.c ****     {
 132:libcanard/drivers/stm32/canard_stm32.c ****         const bool state = (bxcan->MSR & CANARD_STM32_CAN_MSR_INAK) != 0;
 242              		.loc 1 132 0 is_stmt 1
 243 0008 4368     		ldr	r3, [r0, #4]
 244 000a 03F00103 		and	r3, r3, #1
 245 000e DBB2     		uxtb	r3, r3
 246              	.LVL33:
 133:libcanard/drivers/stm32/canard_stm32.c ****         if (state == target_state)
 247              		.loc 1 133 0
 248 0010 8B42     		cmp	r3, r1
 249 0012 04D0     		beq	.L26
 250              	.LBE6:
 130:libcanard/drivers/stm32/canard_stm32.c ****     {
 251              		.loc 1 130 0 discriminator 2
 252 0014 0132     		adds	r2, r2, #1
 253              	.LVL34:
 254 0016 92B2     		uxth	r2, r2
 255              	.LVL35:
 256 0018 F3E7     		b	.L23
 257              	.LVL36:
 258              	.L27:
 259              	.LBE5:
 134:libcanard/drivers/stm32/canard_stm32.c ****         {
 135:libcanard/drivers/stm32/canard_stm32.c ****             return true;
ARM GAS  /tmp/ccmkeNKF.s 			page 8


 136:libcanard/drivers/stm32/canard_stm32.c ****         }
 137:libcanard/drivers/stm32/canard_stm32.c **** 
 138:libcanard/drivers/stm32/canard_stm32.c ****         // Sleep 1 millisecond
 139:libcanard/drivers/stm32/canard_stm32.c ****         //usleep(1000);           // TODO: This function may be missing on some platforms
 140:libcanard/drivers/stm32/canard_stm32.c ****     }
 141:libcanard/drivers/stm32/canard_stm32.c **** 
 142:libcanard/drivers/stm32/canard_stm32.c ****     return false;
 260              		.loc 1 142 0
 261 001a 0020     		movs	r0, #0
 262              	.LVL37:
 263              	.LBB8:
 264 001c 7047     		bx	lr
 265              	.LVL38:
 266              	.L26:
 267              	.LBB7:
 135:libcanard/drivers/stm32/canard_stm32.c ****         }
 268              		.loc 1 135 0
 269 001e 0120     		movs	r0, #1
 270              	.LVL39:
 271              	.LBE7:
 272              	.LBE8:
 143:libcanard/drivers/stm32/canard_stm32.c **** }
 273              		.loc 1 143 0
 274 0020 7047     		bx	lr
 275              		.cfi_endproc
 276              	.LFE4:
 278              		.section	.text.processErrorStatus,"ax",%progbits
 279              		.align	1
 280              		.syntax unified
 281              		.thumb
 282              		.thumb_func
 283              		.fpu softvfp
 285              	processErrorStatus:
 286              	.LFB5:
 144:libcanard/drivers/stm32/canard_stm32.c **** 
 145:libcanard/drivers/stm32/canard_stm32.c **** 
 146:libcanard/drivers/stm32/canard_stm32.c **** static void processErrorStatus(void)
 147:libcanard/drivers/stm32/canard_stm32.c **** {
 287              		.loc 1 147 0
 288              		.cfi_startproc
 289              		@ args = 0, pretend = 0, frame = 0
 290              		@ frame_needed = 0, uses_anonymous_args = 0
 291              		@ link register save eliminated.
 148:libcanard/drivers/stm32/canard_stm32.c ****     /*
 149:libcanard/drivers/stm32/canard_stm32.c ****      * Aborting TX transmissions if abort on error was requested
 150:libcanard/drivers/stm32/canard_stm32.c ****      * Updating error counter
 151:libcanard/drivers/stm32/canard_stm32.c ****      */
 152:libcanard/drivers/stm32/canard_stm32.c ****     const uint8_t lec = (uint8_t)((BXCAN->ESR & CANARD_STM32_CAN_ESR_LEC_MASK) >> CANARD_STM32_CAN_
 292              		.loc 1 152 0
 293 0000 0D4B     		ldr	r3, .L31
 294 0002 9B69     		ldr	r3, [r3, #24]
 295              	.LVL40:
 153:libcanard/drivers/stm32/canard_stm32.c **** 
 154:libcanard/drivers/stm32/canard_stm32.c ****     if (lec != 0)
 296              		.loc 1 154 0
 297 0004 13F0700F 		tst	r3, #112
 298 0008 15D0     		beq	.L28
ARM GAS  /tmp/ccmkeNKF.s 			page 9


 155:libcanard/drivers/stm32/canard_stm32.c ****     {
 156:libcanard/drivers/stm32/canard_stm32.c ****         BXCAN->ESR = 0;                 // This action does only affect the LEC bits, other bits ar
 299              		.loc 1 156 0
 300 000a 0022     		movs	r2, #0
 301 000c 0A4B     		ldr	r3, .L31
 302              	.LVL41:
 303 000e 9A61     		str	r2, [r3, #24]
 157:libcanard/drivers/stm32/canard_stm32.c ****         g_stats.error_count++;
 304              		.loc 1 157 0
 305 0010 0A49     		ldr	r1, .L31+4
 306 0012 D1E90223 		ldrd	r2, [r1, #8]
 307 0016 0132     		adds	r2, r2, #1
 308 0018 43F10003 		adc	r3, r3, #0
 309 001c C1E90223 		strd	r2, [r1, #8]
 158:libcanard/drivers/stm32/canard_stm32.c **** 
 159:libcanard/drivers/stm32/canard_stm32.c ****         // Abort pending transmissions if auto abort on error is enabled, or if we're in bus off mo
 160:libcanard/drivers/stm32/canard_stm32.c ****         if (g_abort_tx_on_error || (BXCAN->ESR & CANARD_STM32_CAN_ESR_BOFF))
 310              		.loc 1 160 0
 311 0020 074B     		ldr	r3, .L31+8
 312 0022 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 313 0024 23B9     		cbnz	r3, .L30
 314              		.loc 1 160 0 is_stmt 0 discriminator 1
 315 0026 044B     		ldr	r3, .L31
 316 0028 9B69     		ldr	r3, [r3, #24]
 317 002a 13F0040F 		tst	r3, #4
 318 002e 02D0     		beq	.L28
 319              	.L30:
 161:libcanard/drivers/stm32/canard_stm32.c ****         {
 162:libcanard/drivers/stm32/canard_stm32.c ****             BXCAN->TSR = CANARD_STM32_CAN_TSR_ABRQ0 | CANARD_STM32_CAN_TSR_ABRQ1 | CANARD_STM32_CAN
 320              		.loc 1 162 0 is_stmt 1
 321 0030 044A     		ldr	r2, .L31+12
 322 0032 014B     		ldr	r3, .L31
 323 0034 9A60     		str	r2, [r3, #8]
 324              	.L28:
 325 0036 7047     		bx	lr
 326              	.L32:
 327              		.align	2
 328              	.L31:
 329 0038 00640040 		.word	1073767424
 330 003c 00000000 		.word	.LANCHOR0
 331 0040 00000000 		.word	.LANCHOR1
 332 0044 80808000 		.word	8421504
 333              		.cfi_endproc
 334              	.LFE5:
 336              		.section	.text.canardSTM32Init,"ax",%progbits
 337              		.align	1
 338              		.global	canardSTM32Init
 339              		.syntax unified
 340              		.thumb
 341              		.thumb_func
 342              		.fpu softvfp
 344              	canardSTM32Init:
 345              	.LFB6:
 163:libcanard/drivers/stm32/canard_stm32.c ****         }
 164:libcanard/drivers/stm32/canard_stm32.c ****     }
 165:libcanard/drivers/stm32/canard_stm32.c **** }
 166:libcanard/drivers/stm32/canard_stm32.c **** 
ARM GAS  /tmp/ccmkeNKF.s 			page 10


 167:libcanard/drivers/stm32/canard_stm32.c **** 
 168:libcanard/drivers/stm32/canard_stm32.c **** int16_t canardSTM32Init(const CanardSTM32CANTimings* const timings,
 169:libcanard/drivers/stm32/canard_stm32.c ****                         const CanardSTM32IfaceMode iface_mode)
 170:libcanard/drivers/stm32/canard_stm32.c **** {
 346              		.loc 1 170 0
 347              		.cfi_startproc
 348              		@ args = 0, pretend = 0, frame = 0
 349              		@ frame_needed = 0, uses_anonymous_args = 0
 350              	.LVL42:
 171:libcanard/drivers/stm32/canard_stm32.c ****     /*
 172:libcanard/drivers/stm32/canard_stm32.c ****      * Paranoia time.
 173:libcanard/drivers/stm32/canard_stm32.c ****      */
 174:libcanard/drivers/stm32/canard_stm32.c ****     if ((iface_mode != CanardSTM32IfaceModeNormal) &&
 351              		.loc 1 174 0
 352 0000 0229     		cmp	r1, #2
 353 0002 00F2B380 		bhi	.L40
 175:libcanard/drivers/stm32/canard_stm32.c ****         (iface_mode != CanardSTM32IfaceModeSilent) &&
 176:libcanard/drivers/stm32/canard_stm32.c ****         (iface_mode != CanardSTM32IfaceModeAutomaticTxAbortOnError))
 177:libcanard/drivers/stm32/canard_stm32.c ****     {
 178:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_ERROR_INVALID_ARGUMENT;
 179:libcanard/drivers/stm32/canard_stm32.c ****     }
 180:libcanard/drivers/stm32/canard_stm32.c **** 
 181:libcanard/drivers/stm32/canard_stm32.c ****     if ((timings == NULL) ||
 354              		.loc 1 181 0
 355 0006 0028     		cmp	r0, #0
 356 0008 00F0B380 		beq	.L41
 170:libcanard/drivers/stm32/canard_stm32.c ****     /*
 357              		.loc 1 170 0 discriminator 1
 358 000c 38B5     		push	{r3, r4, r5, lr}
 359              	.LCFI3:
 360              		.cfi_def_cfa_offset 16
 361              		.cfi_offset 3, -16
 362              		.cfi_offset 4, -12
 363              		.cfi_offset 5, -8
 364              		.cfi_offset 14, -4
 182:libcanard/drivers/stm32/canard_stm32.c ****         (timings->bit_rate_prescaler < 1) || (timings->bit_rate_prescaler > 1024) ||
 365              		.loc 1 182 0 discriminator 1
 366 000e 0388     		ldrh	r3, [r0]
 181:libcanard/drivers/stm32/canard_stm32.c ****         (timings->bit_rate_prescaler < 1) || (timings->bit_rate_prescaler > 1024) ||
 367              		.loc 1 181 0 discriminator 1
 368 0010 002B     		cmp	r3, #0
 369 0012 00F0B180 		beq	.L42
 370              		.loc 1 182 0
 371 0016 B3F5806F 		cmp	r3, #1024
 372 001a 00F2B080 		bhi	.L43
 183:libcanard/drivers/stm32/canard_stm32.c ****         (timings->max_resynchronization_jump_width < 1) || (timings->max_resynchronization_jump_wid
 373              		.loc 1 183 0 discriminator 1
 374 001e 0379     		ldrb	r3, [r0, #4]	@ zero_extendqisi2
 182:libcanard/drivers/stm32/canard_stm32.c ****         (timings->bit_rate_prescaler < 1) || (timings->bit_rate_prescaler > 1024) ||
 375              		.loc 1 182 0 discriminator 1
 376 0020 002B     		cmp	r3, #0
 377 0022 00F0AF80 		beq	.L44
 378              		.loc 1 183 0
 379 0026 042B     		cmp	r3, #4
 380 0028 00F2AF80 		bhi	.L45
 184:libcanard/drivers/stm32/canard_stm32.c ****         (timings->bit_segment_1 < 1) || (timings->bit_segment_1 > 16) ||
 381              		.loc 1 184 0 discriminator 1
ARM GAS  /tmp/ccmkeNKF.s 			page 11


 382 002c 8378     		ldrb	r3, [r0, #2]	@ zero_extendqisi2
 183:libcanard/drivers/stm32/canard_stm32.c ****         (timings->max_resynchronization_jump_width < 1) || (timings->max_resynchronization_jump_wid
 383              		.loc 1 183 0 discriminator 1
 384 002e 002B     		cmp	r3, #0
 385 0030 00F0AE80 		beq	.L46
 386              		.loc 1 184 0
 387 0034 102B     		cmp	r3, #16
 388 0036 00F2AE80 		bhi	.L47
 185:libcanard/drivers/stm32/canard_stm32.c ****         (timings->bit_segment_2 < 1) || (timings->bit_segment_2 > 8))
 389              		.loc 1 185 0 discriminator 1
 390 003a C378     		ldrb	r3, [r0, #3]	@ zero_extendqisi2
 184:libcanard/drivers/stm32/canard_stm32.c ****         (timings->bit_segment_1 < 1) || (timings->bit_segment_1 > 16) ||
 391              		.loc 1 184 0 discriminator 1
 392 003c 002B     		cmp	r3, #0
 393 003e 00F0AD80 		beq	.L48
 394              		.loc 1 185 0
 395 0042 082B     		cmp	r3, #8
 396 0044 00F2AD80 		bhi	.L49
 397 0048 0C46     		mov	r4, r1
 398 004a 0546     		mov	r5, r0
 186:libcanard/drivers/stm32/canard_stm32.c ****     {
 187:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_ERROR_INVALID_ARGUMENT;
 188:libcanard/drivers/stm32/canard_stm32.c ****     }
 189:libcanard/drivers/stm32/canard_stm32.c **** 
 190:libcanard/drivers/stm32/canard_stm32.c ****     /*
 191:libcanard/drivers/stm32/canard_stm32.c ****      * Initial setup
 192:libcanard/drivers/stm32/canard_stm32.c ****      */
 193:libcanard/drivers/stm32/canard_stm32.c ****     memset(&g_stats, 0, sizeof(g_stats));
 399              		.loc 1 193 0
 400 004c 564A     		ldr	r2, .L60
 401 004e 0023     		movs	r3, #0
 402 0050 1360     		str	r3, [r2]
 403 0052 5360     		str	r3, [r2, #4]
 404 0054 9360     		str	r3, [r2, #8]
 405 0056 D360     		str	r3, [r2, #12]
 194:libcanard/drivers/stm32/canard_stm32.c **** 
 195:libcanard/drivers/stm32/canard_stm32.c ****     g_abort_tx_on_error = (iface_mode == CanardSTM32IfaceModeAutomaticTxAbortOnError);
 406              		.loc 1 195 0
 407 0058 0229     		cmp	r1, #2
 408 005a 14BF     		ite	ne
 409 005c 0021     		movne	r1, #0
 410              	.LVL43:
 411 005e 0121     		moveq	r1, #1
 412 0060 524A     		ldr	r2, .L60+4
 413 0062 1170     		strb	r1, [r2]
 196:libcanard/drivers/stm32/canard_stm32.c **** 
 197:libcanard/drivers/stm32/canard_stm32.c **** #if CANARD_STM32_USE_CAN2
 198:libcanard/drivers/stm32/canard_stm32.c ****     // If we're using CAN2, we MUST initialize CAN1 first, because CAN2 is a slave to CAN1.
 199:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->IER = 0;                                 // We need no interrupts
 200:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->MCR &= ~CANARD_STM32_CAN_MCR_SLEEP;      // Exit sleep mode
 201:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->MCR |= CANARD_STM32_CAN_MCR_INRQ;        // Request init
 202:libcanard/drivers/stm32/canard_stm32.c **** 
 203:libcanard/drivers/stm32/canard_stm32.c ****     if (!waitMSRINAKBitStateChange(CANARD_STM32_CAN1, true))    // Wait for synchronization
 204:libcanard/drivers/stm32/canard_stm32.c ****     {
 205:libcanard/drivers/stm32/canard_stm32.c ****         CANARD_STM32_CAN1->MCR = CANARD_STM32_CAN_MCR_RESET;
 206:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_STM32_ERROR_MSR_INAK_NOT_SET;
 207:libcanard/drivers/stm32/canard_stm32.c ****     }
ARM GAS  /tmp/ccmkeNKF.s 			page 12


 208:libcanard/drivers/stm32/canard_stm32.c ****     // CAN1 will be left in the initialization mode forever, in this mode it does not affect the bu
 209:libcanard/drivers/stm32/canard_stm32.c **** #endif
 210:libcanard/drivers/stm32/canard_stm32.c **** 
 211:libcanard/drivers/stm32/canard_stm32.c ****     BXCAN->IER = 0;                                             // We need no interrupts
 414              		.loc 1 211 0
 415 0064 5248     		ldr	r0, .L60+8
 416              	.LVL44:
 417 0066 4361     		str	r3, [r0, #20]
 212:libcanard/drivers/stm32/canard_stm32.c ****     BXCAN->MCR &= ~CANARD_STM32_CAN_MCR_SLEEP;                  // Exit sleep mode
 418              		.loc 1 212 0
 419 0068 0368     		ldr	r3, [r0]
 420 006a 23F00203 		bic	r3, r3, #2
 421 006e 0360     		str	r3, [r0]
 213:libcanard/drivers/stm32/canard_stm32.c ****     BXCAN->MCR |= CANARD_STM32_CAN_MCR_INRQ;                    // Request init
 422              		.loc 1 213 0
 423 0070 0368     		ldr	r3, [r0]
 424 0072 43F00103 		orr	r3, r3, #1
 425 0076 0360     		str	r3, [r0]
 214:libcanard/drivers/stm32/canard_stm32.c **** 
 215:libcanard/drivers/stm32/canard_stm32.c ****     if (!waitMSRINAKBitStateChange(BXCAN, true))                // Wait for synchronization
 426              		.loc 1 215 0
 427 0078 0121     		movs	r1, #1
 428 007a FFF7FEFF 		bl	waitMSRINAKBitStateChange
 429              	.LVL45:
 430 007e 0028     		cmp	r0, #0
 431 0080 57D0     		beq	.L55
 216:libcanard/drivers/stm32/canard_stm32.c ****     {
 217:libcanard/drivers/stm32/canard_stm32.c ****         BXCAN->MCR = CANARD_STM32_CAN_MCR_RESET;
 218:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_STM32_ERROR_MSR_INAK_NOT_SET;
 219:libcanard/drivers/stm32/canard_stm32.c ****     }
 220:libcanard/drivers/stm32/canard_stm32.c **** 
 221:libcanard/drivers/stm32/canard_stm32.c ****     /*
 222:libcanard/drivers/stm32/canard_stm32.c ****      * Hardware initialization (the hardware has already confirmed initialization mode, see above)
 223:libcanard/drivers/stm32/canard_stm32.c ****      */
 224:libcanard/drivers/stm32/canard_stm32.c ****     BXCAN->MCR = CANARD_STM32_CAN_MCR_ABOM | CANARD_STM32_CAN_MCR_AWUM | CANARD_STM32_CAN_MCR_INRQ;
 432              		.loc 1 224 0
 433 0082 6122     		movs	r2, #97
 434 0084 4A4B     		ldr	r3, .L60+8
 435 0086 1A60     		str	r2, [r3]
 225:libcanard/drivers/stm32/canard_stm32.c **** 
 226:libcanard/drivers/stm32/canard_stm32.c ****     BXCAN->BTR = (((timings->max_resynchronization_jump_width - 1U) &    3U) << 24U) |
 436              		.loc 1 226 0
 437 0088 2B79     		ldrb	r3, [r5, #4]	@ zero_extendqisi2
 438 008a 013B     		subs	r3, r3, #1
 439 008c 1B06     		lsls	r3, r3, #24
 440 008e 03F04073 		and	r3, r3, #50331648
 227:libcanard/drivers/stm32/canard_stm32.c ****                  (((timings->bit_segment_1 - 1U)                    &   15U) << 16U) |
 441              		.loc 1 227 0
 442 0092 AA78     		ldrb	r2, [r5, #2]	@ zero_extendqisi2
 443 0094 013A     		subs	r2, r2, #1
 444 0096 1204     		lsls	r2, r2, #16
 445 0098 02F47022 		and	r2, r2, #983040
 226:libcanard/drivers/stm32/canard_stm32.c ****                  (((timings->bit_segment_1 - 1U)                    &   15U) << 16U) |
 446              		.loc 1 226 0
 447 009c 1343     		orrs	r3, r3, r2
 228:libcanard/drivers/stm32/canard_stm32.c ****                  (((timings->bit_segment_2 - 1U)                    &    7U) << 20U) |
 448              		.loc 1 228 0
ARM GAS  /tmp/ccmkeNKF.s 			page 13


 449 009e EA78     		ldrb	r2, [r5, #3]	@ zero_extendqisi2
 450 00a0 013A     		subs	r2, r2, #1
 451 00a2 1205     		lsls	r2, r2, #20
 452 00a4 02F4E002 		and	r2, r2, #7340032
 227:libcanard/drivers/stm32/canard_stm32.c ****                  (((timings->bit_segment_1 - 1U)                    &   15U) << 16U) |
 453              		.loc 1 227 0
 454 00a8 1343     		orrs	r3, r3, r2
 229:libcanard/drivers/stm32/canard_stm32.c ****                  ((timings->bit_rate_prescaler - 1U)                & 1023U) |
 455              		.loc 1 229 0
 456 00aa 2A88     		ldrh	r2, [r5]
 457 00ac 013A     		subs	r2, r2, #1
 458 00ae C2F30902 		ubfx	r2, r2, #0, #10
 228:libcanard/drivers/stm32/canard_stm32.c ****                  (((timings->bit_segment_2 - 1U)                    &    7U) << 20U) |
 459              		.loc 1 228 0
 460 00b2 1343     		orrs	r3, r3, r2
 230:libcanard/drivers/stm32/canard_stm32.c ****                  ((iface_mode == CanardSTM32IfaceModeSilent) ? CANARD_STM32_CAN_BTR_SILM : 0);
 461              		.loc 1 230 0
 462 00b4 012C     		cmp	r4, #1
 463 00b6 43D0     		beq	.L56
 464 00b8 0022     		movs	r2, #0
 465              	.L36:
 229:libcanard/drivers/stm32/canard_stm32.c ****                  ((timings->bit_rate_prescaler - 1U)                & 1023U) |
 466              		.loc 1 229 0
 467 00ba 1343     		orrs	r3, r3, r2
 226:libcanard/drivers/stm32/canard_stm32.c ****                  (((timings->bit_segment_1 - 1U)                    &   15U) << 16U) |
 468              		.loc 1 226 0
 469 00bc 3C4A     		ldr	r2, .L60+8
 470 00be D361     		str	r3, [r2, #28]
 231:libcanard/drivers/stm32/canard_stm32.c **** 
 232:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_ASSERT(0 == BXCAN->IER);             // Making sure the iterrupts are indeed disabled
 471              		.loc 1 232 0
 472 00c0 5369     		ldr	r3, [r2, #20]
 473 00c2 002B     		cmp	r3, #0
 474 00c4 3FD1     		bne	.L57
 233:libcanard/drivers/stm32/canard_stm32.c **** 
 234:libcanard/drivers/stm32/canard_stm32.c ****     BXCAN->MCR &= ~CANARD_STM32_CAN_MCR_INRQ;   // Leave init mode
 475              		.loc 1 234 0
 476 00c6 3A48     		ldr	r0, .L60+8
 477 00c8 0368     		ldr	r3, [r0]
 478 00ca 23F00103 		bic	r3, r3, #1
 479 00ce 0360     		str	r3, [r0]
 235:libcanard/drivers/stm32/canard_stm32.c **** 
 236:libcanard/drivers/stm32/canard_stm32.c ****     if (!waitMSRINAKBitStateChange(BXCAN, false))
 480              		.loc 1 236 0
 481 00d0 0021     		movs	r1, #0
 482 00d2 FFF7FEFF 		bl	waitMSRINAKBitStateChange
 483              	.LVL46:
 484 00d6 0028     		cmp	r0, #0
 485 00d8 3BD0     		beq	.L58
 486              	.LBB9:
 237:libcanard/drivers/stm32/canard_stm32.c ****     {
 238:libcanard/drivers/stm32/canard_stm32.c ****         BXCAN->MCR = CANARD_STM32_CAN_MCR_RESET;
 239:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_STM32_ERROR_MSR_INAK_NOT_CLEARED;
 240:libcanard/drivers/stm32/canard_stm32.c ****     }
 241:libcanard/drivers/stm32/canard_stm32.c **** 
 242:libcanard/drivers/stm32/canard_stm32.c ****     /*
 243:libcanard/drivers/stm32/canard_stm32.c ****      * Default filter configuration. Note that ALL filters are available ONLY via CAN1!
ARM GAS  /tmp/ccmkeNKF.s 			page 14


 244:libcanard/drivers/stm32/canard_stm32.c ****      * CAN2 filters are offset by 14.
 245:libcanard/drivers/stm32/canard_stm32.c ****      * We use 14 filters at most always which simplifies the code and ensures compatibility with al
 246:libcanard/drivers/stm32/canard_stm32.c ****      * MCU within the STM32 family.
 247:libcanard/drivers/stm32/canard_stm32.c ****      */
 248:libcanard/drivers/stm32/canard_stm32.c ****     {
 249:libcanard/drivers/stm32/canard_stm32.c ****         uint32_t fmr = CANARD_STM32_CAN1->FMR & 0xFFFFC0F1U;
 487              		.loc 1 249 0
 488 00da 354A     		ldr	r2, .L60+8
 489 00dc D2F80032 		ldr	r3, [r2, #512]
 490 00e0 23F47C53 		bic	r3, r3, #16128
 491 00e4 23F00E03 		bic	r3, r3, #14
 492              	.LVL47:
 250:libcanard/drivers/stm32/canard_stm32.c ****         fmr |= CANARD_STM32_NUM_ACCEPTANCE_FILTERS << 8U;                // CAN2 start bank = 14 (i
 251:libcanard/drivers/stm32/canard_stm32.c ****         CANARD_STM32_CAN1->FMR = fmr | CANARD_STM32_CAN_FMR_FINIT;
 493              		.loc 1 251 0
 494 00e8 43F46063 		orr	r3, r3, #3584
 495              	.LVL48:
 496 00ec 43F00103 		orr	r3, r3, #1
 497              	.LVL49:
 498 00f0 C2F80032 		str	r3, [r2, #512]
 499              	.LBE9:
 252:libcanard/drivers/stm32/canard_stm32.c ****     }
 253:libcanard/drivers/stm32/canard_stm32.c **** 
 254:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_ASSERT(((CANARD_STM32_CAN1->FMR >> 8U) & 0x3FU) == CANARD_STM32_NUM_ACCEPTANCE_FILTERS);
 500              		.loc 1 254 0
 501 00f4 D2F80032 		ldr	r3, [r2, #512]
 502 00f8 C3F30523 		ubfx	r3, r3, #8, #6
 503 00fc 0E2B     		cmp	r3, #14
 504 00fe 2FD1     		bne	.L59
 255:libcanard/drivers/stm32/canard_stm32.c **** 
 256:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FM1R = 0;                                        // Indentifier Mask mode
 505              		.loc 1 256 0
 506 0100 2B4B     		ldr	r3, .L60+8
 507 0102 0020     		movs	r0, #0
 508 0104 C3F80402 		str	r0, [r3, #516]
 257:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FS1R = 0x0FFFFFFF;                               // All 32-bit
 509              		.loc 1 257 0
 510 0108 6FF07042 		mvn	r2, #-268435456
 511 010c C3F80C22 		str	r2, [r3, #524]
 258:libcanard/drivers/stm32/canard_stm32.c **** 
 259:libcanard/drivers/stm32/canard_stm32.c ****     // Filters are alternating between FIFO0 and FIFO1 in order to equalize the load.
 260:libcanard/drivers/stm32/canard_stm32.c ****     // This will cause occasional priority inversion and frame reordering on reception,
 261:libcanard/drivers/stm32/canard_stm32.c ****     // but that is acceptable for UAVCAN, and a majority of other protocols will tolerate
 262:libcanard/drivers/stm32/canard_stm32.c ****     // this too, since there will be no reordering within the same CAN ID.
 263:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FFA1R = 0x0AAAAAAA;
 512              		.loc 1 263 0
 513 0110 284A     		ldr	r2, .L60+12
 514 0112 C3F81422 		str	r2, [r3, #532]
 264:libcanard/drivers/stm32/canard_stm32.c **** 
 265:libcanard/drivers/stm32/canard_stm32.c **** #if CANARD_STM32_USE_CAN2
 266:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FilterRegister[CANARD_STM32_NUM_ACCEPTANCE_FILTERS].FR1 = 0;
 267:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FilterRegister[CANARD_STM32_NUM_ACCEPTANCE_FILTERS].FR2 = 0;
 268:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FA1R = (1 << CANARD_STM32_NUM_ACCEPTANCE_FILTERS);  // One filter enabled
 269:libcanard/drivers/stm32/canard_stm32.c **** #else
 270:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FilterRegister[0].FR1 = 0;
 515              		.loc 1 270 0
 516 0116 C3F84002 		str	r0, [r3, #576]
ARM GAS  /tmp/ccmkeNKF.s 			page 15


 271:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FilterRegister[0].FR2 = 0;
 517              		.loc 1 271 0
 518 011a C3F84402 		str	r0, [r3, #580]
 272:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FA1R = 1;                                        // One filter enabled
 519              		.loc 1 272 0
 520 011e 0122     		movs	r2, #1
 521 0120 C3F81C22 		str	r2, [r3, #540]
 273:libcanard/drivers/stm32/canard_stm32.c **** #endif
 274:libcanard/drivers/stm32/canard_stm32.c **** 
 275:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FMR &= ~CANARD_STM32_CAN_FMR_FINIT;              // Leave initialization mod
 522              		.loc 1 275 0
 523 0124 D3F80022 		ldr	r2, [r3, #512]
 524 0128 22F00102 		bic	r2, r2, #1
 525 012c C3F80022 		str	r2, [r3, #512]
 276:libcanard/drivers/stm32/canard_stm32.c **** 
 277:libcanard/drivers/stm32/canard_stm32.c ****     return 0;
 526              		.loc 1 277 0
 527 0130 38BD     		pop	{r3, r4, r5, pc}
 528              	.LVL50:
 529              	.L55:
 217:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_STM32_ERROR_MSR_INAK_NOT_SET;
 530              		.loc 1 217 0
 531 0132 4FF40042 		mov	r2, #32768
 532 0136 1E4B     		ldr	r3, .L60+8
 533 0138 1A60     		str	r2, [r3]
 218:libcanard/drivers/stm32/canard_stm32.c ****     }
 534              		.loc 1 218 0
 535 013a 6FF47A70 		mvn	r0, #1000
 536 013e 38BD     		pop	{r3, r4, r5, pc}
 537              	.LVL51:
 538              	.L56:
 230:libcanard/drivers/stm32/canard_stm32.c **** 
 539              		.loc 1 230 0
 540 0140 4FF00042 		mov	r2, #-2147483648
 541 0144 B9E7     		b	.L36
 542              	.L57:
 232:libcanard/drivers/stm32/canard_stm32.c **** 
 543              		.loc 1 232 0 discriminator 1
 544 0146 1C4B     		ldr	r3, .L60+16
 545 0148 1C4A     		ldr	r2, .L60+20
 546 014a E821     		movs	r1, #232
 547 014c 1C48     		ldr	r0, .L60+24
 548 014e FFF7FEFF 		bl	__assert_func
 549              	.LVL52:
 550              	.L58:
 238:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_STM32_ERROR_MSR_INAK_NOT_CLEARED;
 551              		.loc 1 238 0
 552 0152 4FF40042 		mov	r2, #32768
 553 0156 164B     		ldr	r3, .L60+8
 554 0158 1A60     		str	r2, [r3]
 239:libcanard/drivers/stm32/canard_stm32.c ****     }
 555              		.loc 1 239 0
 556 015a A0F2EA30 		subw	r0, r0, #1002
 557 015e 38BD     		pop	{r3, r4, r5, pc}
 558              	.LVL53:
 559              	.L59:
 254:libcanard/drivers/stm32/canard_stm32.c **** 
ARM GAS  /tmp/ccmkeNKF.s 			page 16


 560              		.loc 1 254 0 discriminator 1
 561 0160 184B     		ldr	r3, .L60+28
 562 0162 164A     		ldr	r2, .L60+20
 563 0164 FE21     		movs	r1, #254
 564 0166 1648     		ldr	r0, .L60+24
 565 0168 FFF7FEFF 		bl	__assert_func
 566              	.LVL54:
 567              	.L40:
 568              	.LCFI4:
 569              		.cfi_def_cfa_offset 0
 570              		.cfi_restore 3
 571              		.cfi_restore 4
 572              		.cfi_restore 5
 573              		.cfi_restore 14
 178:libcanard/drivers/stm32/canard_stm32.c ****     }
 574              		.loc 1 178 0
 575 016c 6FF00100 		mvn	r0, #1
 576              	.LVL55:
 577 0170 7047     		bx	lr
 578              	.LVL56:
 579              	.L41:
 187:libcanard/drivers/stm32/canard_stm32.c ****     }
 580              		.loc 1 187 0
 581 0172 6FF00100 		mvn	r0, #1
 582              	.LVL57:
 583 0176 7047     		bx	lr
 584              	.LVL58:
 585              	.L42:
 586              	.LCFI5:
 587              		.cfi_def_cfa_offset 16
 588              		.cfi_offset 3, -16
 589              		.cfi_offset 4, -12
 590              		.cfi_offset 5, -8
 591              		.cfi_offset 14, -4
 592 0178 6FF00100 		mvn	r0, #1
 593              	.LVL59:
 594 017c 38BD     		pop	{r3, r4, r5, pc}
 595              	.LVL60:
 596              	.L43:
 597 017e 6FF00100 		mvn	r0, #1
 598              	.LVL61:
 599 0182 38BD     		pop	{r3, r4, r5, pc}
 600              	.LVL62:
 601              	.L44:
 602 0184 6FF00100 		mvn	r0, #1
 603              	.LVL63:
 604 0188 38BD     		pop	{r3, r4, r5, pc}
 605              	.LVL64:
 606              	.L45:
 607 018a 6FF00100 		mvn	r0, #1
 608              	.LVL65:
 609 018e 38BD     		pop	{r3, r4, r5, pc}
 610              	.LVL66:
 611              	.L46:
 612 0190 6FF00100 		mvn	r0, #1
 613              	.LVL67:
 614 0194 38BD     		pop	{r3, r4, r5, pc}
ARM GAS  /tmp/ccmkeNKF.s 			page 17


 615              	.LVL68:
 616              	.L47:
 617 0196 6FF00100 		mvn	r0, #1
 618              	.LVL69:
 619 019a 38BD     		pop	{r3, r4, r5, pc}
 620              	.LVL70:
 621              	.L48:
 622 019c 6FF00100 		mvn	r0, #1
 623              	.LVL71:
 624 01a0 38BD     		pop	{r3, r4, r5, pc}
 625              	.LVL72:
 626              	.L49:
 627 01a2 6FF00100 		mvn	r0, #1
 628              	.LVL73:
 278:libcanard/drivers/stm32/canard_stm32.c **** }
 629              		.loc 1 278 0
 630 01a6 38BD     		pop	{r3, r4, r5, pc}
 631              	.L61:
 632              		.align	2
 633              	.L60:
 634 01a8 00000000 		.word	.LANCHOR0
 635 01ac 00000000 		.word	.LANCHOR1
 636 01b0 00640040 		.word	1073767424
 637 01b4 AAAAAA0A 		.word	178956970
 638 01b8 00000000 		.word	.LC0
 639 01bc 00000000 		.word	.LANCHOR2
 640 01c0 38000000 		.word	.LC1
 641 01c4 60000000 		.word	.LC2
 642              		.cfi_endproc
 643              	.LFE6:
 645              		.section	.text.canardSTM32Transmit,"ax",%progbits
 646              		.align	1
 647              		.global	canardSTM32Transmit
 648              		.syntax unified
 649              		.thumb
 650              		.thumb_func
 651              		.fpu softvfp
 653              	canardSTM32Transmit:
 654              	.LFB7:
 279:libcanard/drivers/stm32/canard_stm32.c **** 
 280:libcanard/drivers/stm32/canard_stm32.c **** 
 281:libcanard/drivers/stm32/canard_stm32.c **** int16_t canardSTM32Transmit(const CanardCANFrame* const frame)
 282:libcanard/drivers/stm32/canard_stm32.c **** {
 655              		.loc 1 282 0
 656              		.cfi_startproc
 657              		@ args = 0, pretend = 0, frame = 8
 658              		@ frame_needed = 0, uses_anonymous_args = 0
 659              	.LVL74:
 283:libcanard/drivers/stm32/canard_stm32.c ****     if (frame == NULL)
 660              		.loc 1 283 0
 661 0000 0028     		cmp	r0, #0
 662 0002 75D0     		beq	.L70
 282:libcanard/drivers/stm32/canard_stm32.c ****     if (frame == NULL)
 663              		.loc 1 282 0
 664 0004 70B5     		push	{r4, r5, r6, lr}
 665              	.LCFI6:
 666              		.cfi_def_cfa_offset 16
ARM GAS  /tmp/ccmkeNKF.s 			page 18


 667              		.cfi_offset 4, -16
 668              		.cfi_offset 5, -12
 669              		.cfi_offset 6, -8
 670              		.cfi_offset 14, -4
 671 0006 82B0     		sub	sp, sp, #8
 672              	.LCFI7:
 673              		.cfi_def_cfa_offset 24
 674 0008 0546     		mov	r5, r0
 284:libcanard/drivers/stm32/canard_stm32.c ****     {
 285:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_ERROR_INVALID_ARGUMENT;
 286:libcanard/drivers/stm32/canard_stm32.c ****     }
 287:libcanard/drivers/stm32/canard_stm32.c **** 
 288:libcanard/drivers/stm32/canard_stm32.c ****     if (frame->id & CANARD_CAN_FRAME_ERR)
 675              		.loc 1 288 0
 676 000a 0368     		ldr	r3, [r0]
 677 000c 13F0005F 		tst	r3, #536870912
 678 0010 71D1     		bne	.L71
 289:libcanard/drivers/stm32/canard_stm32.c ****     {
 290:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_STM32_ERROR_UNSUPPORTED_FRAME_FORMAT;
 291:libcanard/drivers/stm32/canard_stm32.c ****     }
 292:libcanard/drivers/stm32/canard_stm32.c **** 
 293:libcanard/drivers/stm32/canard_stm32.c ****     /*
 294:libcanard/drivers/stm32/canard_stm32.c ****      * Handling error status might free up some slots through aborts
 295:libcanard/drivers/stm32/canard_stm32.c ****      */
 296:libcanard/drivers/stm32/canard_stm32.c ****     processErrorStatus();
 679              		.loc 1 296 0
 680 0012 FFF7FEFF 		bl	processErrorStatus
 681              	.LVL75:
 297:libcanard/drivers/stm32/canard_stm32.c **** 
 298:libcanard/drivers/stm32/canard_stm32.c ****     /*
 299:libcanard/drivers/stm32/canard_stm32.c ****      * Seeking an empty slot, checking if priority inversion would occur if we enqueued now.
 300:libcanard/drivers/stm32/canard_stm32.c ****      * We can always enqueue safely if all TX mailboxes are free and no transmissions are pending.
 301:libcanard/drivers/stm32/canard_stm32.c ****      */
 302:libcanard/drivers/stm32/canard_stm32.c ****     uint8_t tx_mailbox = 0xFF;
 303:libcanard/drivers/stm32/canard_stm32.c **** 
 304:libcanard/drivers/stm32/canard_stm32.c ****     static const uint32_t AllTME = CANARD_STM32_CAN_TSR_TME0 | CANARD_STM32_CAN_TSR_TME1 | CANARD_S
 305:libcanard/drivers/stm32/canard_stm32.c **** 
 306:libcanard/drivers/stm32/canard_stm32.c ****     if ((BXCAN->TSR & AllTME) != AllTME)                // At least one TX mailbox is used, detaile
 682              		.loc 1 306 0
 683 0016 394B     		ldr	r3, .L81
 684 0018 9B68     		ldr	r3, [r3, #8]
 685 001a 03F0E053 		and	r3, r3, #469762048
 686 001e B3F1E05F 		cmp	r3, #469762048
 687 0022 5CD0     		beq	.L72
 688              	.LBB10:
 307:libcanard/drivers/stm32/canard_stm32.c ****     {
 308:libcanard/drivers/stm32/canard_stm32.c ****         const bool tme[3] =
 309:libcanard/drivers/stm32/canard_stm32.c ****         {
 310:libcanard/drivers/stm32/canard_stm32.c ****             (BXCAN->TSR & CANARD_STM32_CAN_TSR_TME0) != 0,
 689              		.loc 1 310 0
 690 0024 354B     		ldr	r3, .L81
 691 0026 9A68     		ldr	r2, [r3, #8]
 692 0028 C2F38062 		ubfx	r2, r2, #26, #1
 308:libcanard/drivers/stm32/canard_stm32.c ****         {
 693              		.loc 1 308 0
 694 002c 8DF80420 		strb	r2, [sp, #4]
 311:libcanard/drivers/stm32/canard_stm32.c ****             (BXCAN->TSR & CANARD_STM32_CAN_TSR_TME1) != 0,
ARM GAS  /tmp/ccmkeNKF.s 			page 19


 695              		.loc 1 311 0
 696 0030 9A68     		ldr	r2, [r3, #8]
 697 0032 C2F3C062 		ubfx	r2, r2, #27, #1
 308:libcanard/drivers/stm32/canard_stm32.c ****         {
 698              		.loc 1 308 0
 699 0036 8DF80520 		strb	r2, [sp, #5]
 312:libcanard/drivers/stm32/canard_stm32.c ****             (BXCAN->TSR & CANARD_STM32_CAN_TSR_TME2) != 0
 700              		.loc 1 312 0
 701 003a 9B68     		ldr	r3, [r3, #8]
 702 003c C3F30073 		ubfx	r3, r3, #28, #1
 308:libcanard/drivers/stm32/canard_stm32.c ****         {
 703              		.loc 1 308 0
 704 0040 8DF80630 		strb	r3, [sp, #6]
 705              	.LVL76:
 706              	.LBB11:
 313:libcanard/drivers/stm32/canard_stm32.c ****         };
 314:libcanard/drivers/stm32/canard_stm32.c **** 
 315:libcanard/drivers/stm32/canard_stm32.c ****         for (uint8_t i = 0; i < 3; i++)
 707              		.loc 1 315 0
 708 0044 0024     		movs	r4, #0
 709              	.LBE11:
 710              	.LBE10:
 302:libcanard/drivers/stm32/canard_stm32.c **** 
 711              		.loc 1 302 0
 712 0046 FF26     		movs	r6, #255
 713              	.LBB13:
 714              	.LBB12:
 715              		.loc 1 315 0
 716 0048 02E0     		b	.L65
 717              	.LVL77:
 718              	.L73:
 316:libcanard/drivers/stm32/canard_stm32.c ****         {
 317:libcanard/drivers/stm32/canard_stm32.c ****             if (tme[i])                                 // This TX mailbox is free, we can use it
 318:libcanard/drivers/stm32/canard_stm32.c ****             {
 319:libcanard/drivers/stm32/canard_stm32.c ****                 tx_mailbox = i;
 719              		.loc 1 319 0
 720 004a 2646     		mov	r6, r4
 721              	.LVL78:
 722              	.L66:
 315:libcanard/drivers/stm32/canard_stm32.c ****         {
 723              		.loc 1 315 0 discriminator 2
 724 004c 0134     		adds	r4, r4, #1
 725              	.LVL79:
 726 004e E4B2     		uxtb	r4, r4
 727              	.LVL80:
 728              	.L65:
 315:libcanard/drivers/stm32/canard_stm32.c ****         {
 729              		.loc 1 315 0 is_stmt 0 discriminator 1
 730 0050 022C     		cmp	r4, #2
 731 0052 13D8     		bhi	.L78
 317:libcanard/drivers/stm32/canard_stm32.c ****             {
 732              		.loc 1 317 0 is_stmt 1
 733 0054 02AB     		add	r3, sp, #8
 734 0056 2344     		add	r3, r3, r4
 735 0058 13F8043C 		ldrb	r3, [r3, #-4]	@ zero_extendqisi2
 736 005c 002B     		cmp	r3, #0
 737 005e F4D1     		bne	.L73
ARM GAS  /tmp/ccmkeNKF.s 			page 20


 320:libcanard/drivers/stm32/canard_stm32.c ****             }
 321:libcanard/drivers/stm32/canard_stm32.c ****             else                                        // This TX mailbox is pending, check for pr
 322:libcanard/drivers/stm32/canard_stm32.c ****             {
 323:libcanard/drivers/stm32/canard_stm32.c ****                 if (!isFramePriorityHigher(frame->id, convertFrameIDRegisterToCanard(BXCAN->TxMailb
 738              		.loc 1 323 0
 739 0060 04F11803 		add	r3, r4, #24
 740 0064 1B01     		lsls	r3, r3, #4
 741 0066 254A     		ldr	r2, .L81
 742 0068 D058     		ldr	r0, [r2, r3]
 743 006a FFF7FEFF 		bl	convertFrameIDRegisterToCanard
 744              	.LVL81:
 745 006e 0146     		mov	r1, r0
 746 0070 2868     		ldr	r0, [r5]
 747 0072 FFF7FEFF 		bl	isFramePriorityHigher
 748              	.LVL82:
 749 0076 0028     		cmp	r0, #0
 750 0078 E8D1     		bne	.L66
 751 007a 27E0     		b	.L63
 752              	.L78:
 753              	.LBE12:
 324:libcanard/drivers/stm32/canard_stm32.c ****                 {
 325:libcanard/drivers/stm32/canard_stm32.c ****                     // There's a mailbox whose priority is higher or equal the priority of the new 
 326:libcanard/drivers/stm32/canard_stm32.c ****                     return 0;                           // Priority inversion would occur! Reject t
 327:libcanard/drivers/stm32/canard_stm32.c ****                 }
 328:libcanard/drivers/stm32/canard_stm32.c ****             }
 329:libcanard/drivers/stm32/canard_stm32.c ****         }
 330:libcanard/drivers/stm32/canard_stm32.c **** 
 331:libcanard/drivers/stm32/canard_stm32.c ****         if (tx_mailbox == 0xFF)
 754              		.loc 1 331 0
 755 007c FF2E     		cmp	r6, #255
 756 007e 27D0     		beq	.L79
 757              	.LVL83:
 758              	.L64:
 759              	.LBE13:
 332:libcanard/drivers/stm32/canard_stm32.c ****         {
 333:libcanard/drivers/stm32/canard_stm32.c ****             /*
 334:libcanard/drivers/stm32/canard_stm32.c ****              * All TX mailboxes are busy (this is highly unlikely); at the same time we know that t
 335:libcanard/drivers/stm32/canard_stm32.c ****              * higher or equal priority frame that is currently pending. Therefore, priority invers
 336:libcanard/drivers/stm32/canard_stm32.c ****              * just happend (sic!), because we can't enqueue the higher priority frame due to all T
 337:libcanard/drivers/stm32/canard_stm32.c ****              * being busy. This scenario is extremely unlikely, because in order for it to happen, 
 338:libcanard/drivers/stm32/canard_stm32.c ****              * would need to transmit 4 (four) or more CAN frames with different CAN ID ordered fro
 339:libcanard/drivers/stm32/canard_stm32.c ****              * low ID nearly at the same time. For example:
 340:libcanard/drivers/stm32/canard_stm32.c ****              *  1. 0x123        <-- Takes mailbox 0 (or any other)
 341:libcanard/drivers/stm32/canard_stm32.c ****              *  2. 0x122        <-- Takes mailbox 2 (or any other)
 342:libcanard/drivers/stm32/canard_stm32.c ****              *  3. 0x121        <-- Takes mailbox 1 (or any other)
 343:libcanard/drivers/stm32/canard_stm32.c ****              *  4. 0x120        <-- INNER PRIORITY INVERSION HERE (only if all three TX mailboxes a
 344:libcanard/drivers/stm32/canard_stm32.c ****              * This situation is even less likely to cause any noticeable disruptions on the CAN bu
 345:libcanard/drivers/stm32/canard_stm32.c ****              * it is better to warn the developer about that during debugging, so we fire an assert
 346:libcanard/drivers/stm32/canard_stm32.c ****              * It is perfectly safe to remove it.
 347:libcanard/drivers/stm32/canard_stm32.c ****              */
 348:libcanard/drivers/stm32/canard_stm32.c **** #if CANARD_STM32_DEBUG_INNER_PRIORITY_INVERSION
 349:libcanard/drivers/stm32/canard_stm32.c ****             CANARD_ASSERT(!"CAN PRIO INV");
 350:libcanard/drivers/stm32/canard_stm32.c **** #endif
 351:libcanard/drivers/stm32/canard_stm32.c ****             return 0;
 352:libcanard/drivers/stm32/canard_stm32.c ****         }
 353:libcanard/drivers/stm32/canard_stm32.c ****     }
 354:libcanard/drivers/stm32/canard_stm32.c ****     else                                                // All TX mailboxes are free, use first
ARM GAS  /tmp/ccmkeNKF.s 			page 21


 355:libcanard/drivers/stm32/canard_stm32.c ****     {
 356:libcanard/drivers/stm32/canard_stm32.c ****         tx_mailbox = 0;
 357:libcanard/drivers/stm32/canard_stm32.c ****     }
 358:libcanard/drivers/stm32/canard_stm32.c **** 
 359:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_ASSERT(tx_mailbox < 3);                      // Index check - the value must be correct 
 760              		.loc 1 359 0
 761 0080 022E     		cmp	r6, #2
 762 0082 2ED8     		bhi	.L80
 360:libcanard/drivers/stm32/canard_stm32.c **** 
 361:libcanard/drivers/stm32/canard_stm32.c ****     /*
 362:libcanard/drivers/stm32/canard_stm32.c ****      * By this time we've proved that a priority inversion would not occur, and we've also found a 
 363:libcanard/drivers/stm32/canard_stm32.c ****      * Therefore it is safe to enqueue the frame now.
 364:libcanard/drivers/stm32/canard_stm32.c ****      */
 365:libcanard/drivers/stm32/canard_stm32.c ****     volatile CanardSTM32TxMailboxType* const mb = &BXCAN->TxMailbox[tx_mailbox];
 763              		.loc 1 365 0
 764 0084 3401     		lsls	r4, r6, #4
 765 0086 04F18044 		add	r4, r4, #1073741824
 766 008a 04F5CB44 		add	r4, r4, #25984
 767              	.LVL84:
 366:libcanard/drivers/stm32/canard_stm32.c **** 
 367:libcanard/drivers/stm32/canard_stm32.c ****     mb->TDTR = frame->data_len;                         // DLC equals data length except in CAN FD
 768              		.loc 1 367 0
 769 008e 2B7B     		ldrb	r3, [r5, #12]	@ zero_extendqisi2
 770 0090 6360     		str	r3, [r4, #4]
 368:libcanard/drivers/stm32/canard_stm32.c **** 
 369:libcanard/drivers/stm32/canard_stm32.c ****     mb->TDHR = (((uint32_t)frame->data[7]) << 24U) |
 771              		.loc 1 369 0
 772 0092 EA7A     		ldrb	r2, [r5, #11]	@ zero_extendqisi2
 370:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[6]) << 16U) |
 773              		.loc 1 370 0
 774 0094 AB7A     		ldrb	r3, [r5, #10]	@ zero_extendqisi2
 775 0096 1B04     		lsls	r3, r3, #16
 369:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[6]) << 16U) |
 776              		.loc 1 369 0
 777 0098 43EA0263 		orr	r3, r3, r2, lsl #24
 371:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[5]) <<  8U) |
 778              		.loc 1 371 0
 779 009c 6A7A     		ldrb	r2, [r5, #9]	@ zero_extendqisi2
 370:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[6]) << 16U) |
 780              		.loc 1 370 0
 781 009e 43EA0223 		orr	r3, r3, r2, lsl #8
 372:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[4]) <<  0U);
 782              		.loc 1 372 0
 783 00a2 2A7A     		ldrb	r2, [r5, #8]	@ zero_extendqisi2
 371:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[5]) <<  8U) |
 784              		.loc 1 371 0
 785 00a4 1343     		orrs	r3, r3, r2
 369:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[6]) << 16U) |
 786              		.loc 1 369 0
 787 00a6 E360     		str	r3, [r4, #12]
 373:libcanard/drivers/stm32/canard_stm32.c ****     mb->TDLR = (((uint32_t)frame->data[3]) << 24U) |
 788              		.loc 1 373 0
 789 00a8 EA79     		ldrb	r2, [r5, #7]	@ zero_extendqisi2
 374:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[2]) << 16U) |
 790              		.loc 1 374 0
 791 00aa AB79     		ldrb	r3, [r5, #6]	@ zero_extendqisi2
 792 00ac 1B04     		lsls	r3, r3, #16
ARM GAS  /tmp/ccmkeNKF.s 			page 22


 373:libcanard/drivers/stm32/canard_stm32.c ****     mb->TDLR = (((uint32_t)frame->data[3]) << 24U) |
 793              		.loc 1 373 0
 794 00ae 43EA0263 		orr	r3, r3, r2, lsl #24
 375:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[1]) <<  8U) |
 795              		.loc 1 375 0
 796 00b2 6A79     		ldrb	r2, [r5, #5]	@ zero_extendqisi2
 374:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[2]) << 16U) |
 797              		.loc 1 374 0
 798 00b4 43EA0223 		orr	r3, r3, r2, lsl #8
 376:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[0]) <<  0U);
 799              		.loc 1 376 0
 800 00b8 2A79     		ldrb	r2, [r5, #4]	@ zero_extendqisi2
 375:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[1]) <<  8U) |
 801              		.loc 1 375 0
 802 00ba 1343     		orrs	r3, r3, r2
 373:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[2]) << 16U) |
 803              		.loc 1 373 0
 804 00bc A360     		str	r3, [r4, #8]
 377:libcanard/drivers/stm32/canard_stm32.c **** 
 378:libcanard/drivers/stm32/canard_stm32.c ****     mb->TIR = convertFrameIDCanardToRegister(frame->id) | CANARD_STM32_CAN_TIR_TXRQ;    // Go.
 805              		.loc 1 378 0
 806 00be 2868     		ldr	r0, [r5]
 807 00c0 FFF7FEFF 		bl	convertFrameIDCanardToRegister
 808              	.LVL85:
 809 00c4 40F00100 		orr	r0, r0, #1
 810 00c8 2060     		str	r0, [r4]
 379:libcanard/drivers/stm32/canard_stm32.c **** 
 380:libcanard/drivers/stm32/canard_stm32.c ****     /*
 381:libcanard/drivers/stm32/canard_stm32.c ****      * The frame is now enqueued and pending transmission.
 382:libcanard/drivers/stm32/canard_stm32.c ****      */
 383:libcanard/drivers/stm32/canard_stm32.c ****     return 1;
 811              		.loc 1 383 0
 812 00ca 0120     		movs	r0, #1
 813              	.LVL86:
 814              	.L63:
 384:libcanard/drivers/stm32/canard_stm32.c **** }
 815              		.loc 1 384 0
 816 00cc 02B0     		add	sp, sp, #8
 817              	.LCFI8:
 818              		.cfi_remember_state
 819              		.cfi_def_cfa_offset 16
 820              		@ sp needed
 821 00ce 70BD     		pop	{r4, r5, r6, pc}
 822              	.LVL87:
 823              	.L79:
 824              	.LCFI9:
 825              		.cfi_restore_state
 826              	.LBB14:
 349:libcanard/drivers/stm32/canard_stm32.c **** #endif
 827              		.loc 1 349 0
 828 00d0 0B4B     		ldr	r3, .L81+4
 829 00d2 0C4A     		ldr	r2, .L81+8
 830 00d4 40F25D11 		movw	r1, #349
 831 00d8 0B48     		ldr	r0, .L81+12
 832 00da FFF7FEFF 		bl	__assert_func
 833              	.LVL88:
 834              	.L72:
ARM GAS  /tmp/ccmkeNKF.s 			page 23


 835              	.LBE14:
 356:libcanard/drivers/stm32/canard_stm32.c ****     }
 836              		.loc 1 356 0
 837 00de 0026     		movs	r6, #0
 838 00e0 CEE7     		b	.L64
 839              	.LVL89:
 840              	.L80:
 359:libcanard/drivers/stm32/canard_stm32.c **** 
 841              		.loc 1 359 0 discriminator 1
 842 00e2 0A4B     		ldr	r3, .L81+16
 843 00e4 074A     		ldr	r2, .L81+8
 844 00e6 40F26711 		movw	r1, #359
 845 00ea 0748     		ldr	r0, .L81+12
 846 00ec FFF7FEFF 		bl	__assert_func
 847              	.LVL90:
 848              	.L70:
 849              	.LCFI10:
 850              		.cfi_def_cfa_offset 0
 851              		.cfi_restore 4
 852              		.cfi_restore 5
 853              		.cfi_restore 6
 854              		.cfi_restore 14
 285:libcanard/drivers/stm32/canard_stm32.c ****     }
 855              		.loc 1 285 0
 856 00f0 6FF00100 		mvn	r0, #1
 857              	.LVL91:
 858 00f4 7047     		bx	lr
 859              	.LVL92:
 860              	.L71:
 861              	.LCFI11:
 862              		.cfi_def_cfa_offset 24
 863              		.cfi_offset 4, -16
 864              		.cfi_offset 5, -12
 865              		.cfi_offset 6, -8
 866              		.cfi_offset 14, -4
 290:libcanard/drivers/stm32/canard_stm32.c ****     }
 867              		.loc 1 290 0
 868 00f6 0648     		ldr	r0, .L81+20
 869              	.LVL93:
 870 00f8 E8E7     		b	.L63
 871              	.L82:
 872 00fa 00BF     		.align	2
 873              	.L81:
 874 00fc 00640040 		.word	1073767424
 875 0100 00000000 		.word	.LC3
 876 0104 00000000 		.word	.LANCHOR3
 877 0108 38000000 		.word	.LC1
 878 010c 10000000 		.word	.LC4
 879 0110 15FCFFFF 		.word	-1003
 880              		.cfi_endproc
 881              	.LFE7:
 883              		.section	.text.canardSTM32Receive,"ax",%progbits
 884              		.align	1
 885              		.global	canardSTM32Receive
 886              		.syntax unified
 887              		.thumb
 888              		.thumb_func
ARM GAS  /tmp/ccmkeNKF.s 			page 24


 889              		.fpu softvfp
 891              	canardSTM32Receive:
 892              	.LFB8:
 385:libcanard/drivers/stm32/canard_stm32.c **** 
 386:libcanard/drivers/stm32/canard_stm32.c **** 
 387:libcanard/drivers/stm32/canard_stm32.c **** int16_t canardSTM32Receive(CanardCANFrame* const out_frame)
 388:libcanard/drivers/stm32/canard_stm32.c **** {
 893              		.loc 1 388 0
 894              		.cfi_startproc
 895              		@ args = 0, pretend = 0, frame = 0
 896              		@ frame_needed = 0, uses_anonymous_args = 0
 897              	.LVL94:
 389:libcanard/drivers/stm32/canard_stm32.c ****     if (out_frame == NULL)
 898              		.loc 1 389 0
 899 0000 0028     		cmp	r0, #0
 900 0002 40D0     		beq	.L89
 388:libcanard/drivers/stm32/canard_stm32.c ****     if (out_frame == NULL)
 901              		.loc 1 388 0
 902 0004 70B5     		push	{r4, r5, r6, lr}
 903              	.LCFI12:
 904              		.cfi_def_cfa_offset 16
 905              		.cfi_offset 4, -16
 906              		.cfi_offset 5, -12
 907              		.cfi_offset 6, -8
 908              		.cfi_offset 14, -4
 909 0006 0646     		mov	r6, r0
 390:libcanard/drivers/stm32/canard_stm32.c ****     {
 391:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_ERROR_INVALID_ARGUMENT;
 392:libcanard/drivers/stm32/canard_stm32.c ****     }
 393:libcanard/drivers/stm32/canard_stm32.c **** 
 394:libcanard/drivers/stm32/canard_stm32.c ****     static volatile uint32_t* const RFxR[2] =
 395:libcanard/drivers/stm32/canard_stm32.c ****     {
 396:libcanard/drivers/stm32/canard_stm32.c ****         &BXCAN->RF0R,
 397:libcanard/drivers/stm32/canard_stm32.c ****         &BXCAN->RF1R
 398:libcanard/drivers/stm32/canard_stm32.c ****     };
 399:libcanard/drivers/stm32/canard_stm32.c **** 
 400:libcanard/drivers/stm32/canard_stm32.c ****     /*
 401:libcanard/drivers/stm32/canard_stm32.c ****      * This function must be polled periodically, so we use this opportunity to do it.
 402:libcanard/drivers/stm32/canard_stm32.c ****      */
 403:libcanard/drivers/stm32/canard_stm32.c ****     processErrorStatus();
 910              		.loc 1 403 0
 911 0008 FFF7FEFF 		bl	processErrorStatus
 912              	.LVL95:
 913              	.LBB15:
 404:libcanard/drivers/stm32/canard_stm32.c **** 
 405:libcanard/drivers/stm32/canard_stm32.c ****     /*
 406:libcanard/drivers/stm32/canard_stm32.c ****      * Reading the TX FIFO
 407:libcanard/drivers/stm32/canard_stm32.c ****      */
 408:libcanard/drivers/stm32/canard_stm32.c ****     for (uint_fast8_t i = 0; i < 2; i++)
 914              		.loc 1 408 0
 915 000c 0023     		movs	r3, #0
 916              	.LVL96:
 917              	.L85:
 918              		.loc 1 408 0 is_stmt 0 discriminator 1
 919 000e 012B     		cmp	r3, #1
 920 0010 37D8     		bhi	.L94
 921              	.LBB16:
ARM GAS  /tmp/ccmkeNKF.s 			page 25


 409:libcanard/drivers/stm32/canard_stm32.c ****     {
 410:libcanard/drivers/stm32/canard_stm32.c ****         volatile CanardSTM32RxMailboxType* const mb = &BXCAN->RxMailbox[i];
 922              		.loc 1 410 0 is_stmt 1
 923 0012 1E4C     		ldr	r4, .L96
 924 0014 04EB0314 		add	r4, r4, r3, lsl #4
 925              	.LVL97:
 411:libcanard/drivers/stm32/canard_stm32.c **** 
 412:libcanard/drivers/stm32/canard_stm32.c ****         if (((*RFxR[i]) & CANARD_STM32_CAN_RFR_FMP_MASK) != 0)
 926              		.loc 1 412 0
 927 0018 1D4A     		ldr	r2, .L96+4
 928 001a 52F82350 		ldr	r5, [r2, r3, lsl #2]
 929 001e 2A68     		ldr	r2, [r5]
 930 0020 12F0030F 		tst	r2, #3
 931 0024 01D1     		bne	.L95
 932              	.LBE16:
 408:libcanard/drivers/stm32/canard_stm32.c ****     {
 933              		.loc 1 408 0 discriminator 2
 934 0026 0133     		adds	r3, r3, #1
 935              	.LVL98:
 936 0028 F1E7     		b	.L85
 937              	.L95:
 938              	.LBB18:
 939              	.LBB17:
 413:libcanard/drivers/stm32/canard_stm32.c ****         {
 414:libcanard/drivers/stm32/canard_stm32.c ****             if (*RFxR[i] & CANARD_STM32_CAN_RFR_FOVR)
 940              		.loc 1 414 0
 941 002a 2B68     		ldr	r3, [r5]
 942              	.LVL99:
 943 002c 13F0100F 		tst	r3, #16
 944 0030 07D0     		beq	.L87
 415:libcanard/drivers/stm32/canard_stm32.c ****             {
 416:libcanard/drivers/stm32/canard_stm32.c ****                 g_stats.rx_overflow_count++;
 945              		.loc 1 416 0
 946 0032 1849     		ldr	r1, .L96+8
 947 0034 D1E90023 		ldrd	r2, [r1]
 948 0038 0132     		adds	r2, r2, #1
 949 003a 43F10003 		adc	r3, r3, #0
 950 003e C1E90023 		strd	r2, [r1]
 951              	.L87:
 417:libcanard/drivers/stm32/canard_stm32.c ****             }
 418:libcanard/drivers/stm32/canard_stm32.c **** 
 419:libcanard/drivers/stm32/canard_stm32.c ****             out_frame->id = convertFrameIDRegisterToCanard(mb->RIR);
 952              		.loc 1 419 0
 953 0042 2068     		ldr	r0, [r4]
 954 0044 FFF7FEFF 		bl	convertFrameIDRegisterToCanard
 955              	.LVL100:
 956 0048 3060     		str	r0, [r6]
 420:libcanard/drivers/stm32/canard_stm32.c **** 
 421:libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data_len = (uint8_t)(mb->RDTR & CANARD_STM32_CAN_RDTR_DLC_MASK);
 957              		.loc 1 421 0
 958 004a 6368     		ldr	r3, [r4, #4]
 959 004c 03F00F03 		and	r3, r3, #15
 960 0050 3373     		strb	r3, [r6, #12]
 422:libcanard/drivers/stm32/canard_stm32.c **** 
 423:libcanard/drivers/stm32/canard_stm32.c ****             // Caching to regular (non volatile) memory for faster reads
 424:libcanard/drivers/stm32/canard_stm32.c ****             const uint32_t rdlr = mb->RDLR;
 961              		.loc 1 424 0
ARM GAS  /tmp/ccmkeNKF.s 			page 26


 962 0052 A268     		ldr	r2, [r4, #8]
 963              	.LVL101:
 425:libcanard/drivers/stm32/canard_stm32.c ****             const uint32_t rdhr = mb->RDHR;
 964              		.loc 1 425 0
 965 0054 E368     		ldr	r3, [r4, #12]
 966              	.LVL102:
 426:libcanard/drivers/stm32/canard_stm32.c **** 
 427:libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[0] = (uint8_t)(0xFFU & (rdlr >>  0U));
 967              		.loc 1 427 0
 968 0056 3271     		strb	r2, [r6, #4]
 428:libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[1] = (uint8_t)(0xFFU & (rdlr >>  8U));
 969              		.loc 1 428 0
 970 0058 C2F30721 		ubfx	r1, r2, #8, #8
 971 005c 7171     		strb	r1, [r6, #5]
 429:libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[2] = (uint8_t)(0xFFU & (rdlr >> 16U));
 972              		.loc 1 429 0
 973 005e C2F30741 		ubfx	r1, r2, #16, #8
 974 0062 B171     		strb	r1, [r6, #6]
 430:libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[3] = (uint8_t)(0xFFU & (rdlr >> 24U));
 975              		.loc 1 430 0
 976 0064 120E     		lsrs	r2, r2, #24
 977              	.LVL103:
 978 0066 F271     		strb	r2, [r6, #7]
 431:libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[4] = (uint8_t)(0xFFU & (rdhr >>  0U));
 979              		.loc 1 431 0
 980 0068 3372     		strb	r3, [r6, #8]
 432:libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[5] = (uint8_t)(0xFFU & (rdhr >>  8U));
 981              		.loc 1 432 0
 982 006a C3F30722 		ubfx	r2, r3, #8, #8
 983 006e 7272     		strb	r2, [r6, #9]
 433:libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[6] = (uint8_t)(0xFFU & (rdhr >> 16U));
 984              		.loc 1 433 0
 985 0070 C3F30742 		ubfx	r2, r3, #16, #8
 986 0074 B272     		strb	r2, [r6, #10]
 434:libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[7] = (uint8_t)(0xFFU & (rdhr >> 24U));
 987              		.loc 1 434 0
 988 0076 1B0E     		lsrs	r3, r3, #24
 989              	.LVL104:
 990 0078 F372     		strb	r3, [r6, #11]
 435:libcanard/drivers/stm32/canard_stm32.c **** 
 436:libcanard/drivers/stm32/canard_stm32.c ****             // Release FIFO entry we just read
 437:libcanard/drivers/stm32/canard_stm32.c ****             *RFxR[i] = CANARD_STM32_CAN_RFR_RFOM | CANARD_STM32_CAN_RFR_FOVR | CANARD_STM32_CAN_RFR
 991              		.loc 1 437 0
 992 007a 3823     		movs	r3, #56
 993 007c 2B60     		str	r3, [r5]
 438:libcanard/drivers/stm32/canard_stm32.c **** 
 439:libcanard/drivers/stm32/canard_stm32.c ****             // Reading successful
 440:libcanard/drivers/stm32/canard_stm32.c ****             return 1;
 994              		.loc 1 440 0
 995 007e 0120     		movs	r0, #1
 996 0080 70BD     		pop	{r4, r5, r6, pc}
 997              	.LVL105:
 998              	.L94:
 999              	.LBE17:
 1000              	.LBE18:
 1001              	.LBE15:
 441:libcanard/drivers/stm32/canard_stm32.c ****         }
ARM GAS  /tmp/ccmkeNKF.s 			page 27


 442:libcanard/drivers/stm32/canard_stm32.c ****     }
 443:libcanard/drivers/stm32/canard_stm32.c **** 
 444:libcanard/drivers/stm32/canard_stm32.c ****     // No frames to read
 445:libcanard/drivers/stm32/canard_stm32.c ****     return 0;
 1002              		.loc 1 445 0
 1003 0082 0020     		movs	r0, #0
 1004              	.LBB19:
 1005 0084 70BD     		pop	{r4, r5, r6, pc}
 1006              	.LVL106:
 1007              	.L89:
 1008              	.LCFI13:
 1009              		.cfi_def_cfa_offset 0
 1010              		.cfi_restore 4
 1011              		.cfi_restore 5
 1012              		.cfi_restore 6
 1013              		.cfi_restore 14
 1014              	.LBE19:
 391:libcanard/drivers/stm32/canard_stm32.c ****     }
 1015              		.loc 1 391 0
 1016 0086 6FF00100 		mvn	r0, #1
 1017              	.LVL107:
 1018 008a 7047     		bx	lr
 1019              	.L97:
 1020              		.align	2
 1021              	.L96:
 1022 008c B0650040 		.word	1073767856
 1023 0090 00000000 		.word	.LANCHOR4
 1024 0094 00000000 		.word	.LANCHOR0
 1025              		.cfi_endproc
 1026              	.LFE8:
 1028              		.section	.text.canardSTM32ConfigureAcceptanceFilters,"ax",%progbits
 1029              		.align	1
 1030              		.global	canardSTM32ConfigureAcceptanceFilters
 1031              		.syntax unified
 1032              		.thumb
 1033              		.thumb_func
 1034              		.fpu softvfp
 1036              	canardSTM32ConfigureAcceptanceFilters:
 1037              	.LFB9:
 446:libcanard/drivers/stm32/canard_stm32.c **** }
 447:libcanard/drivers/stm32/canard_stm32.c **** 
 448:libcanard/drivers/stm32/canard_stm32.c **** 
 449:libcanard/drivers/stm32/canard_stm32.c **** int16_t canardSTM32ConfigureAcceptanceFilters(const CanardSTM32AcceptanceFilterConfiguration* const
 450:libcanard/drivers/stm32/canard_stm32.c ****                                               const uint8_t num_filter_configs)
 451:libcanard/drivers/stm32/canard_stm32.c **** {
 1038              		.loc 1 451 0
 1039              		.cfi_startproc
 1040              		@ args = 0, pretend = 0, frame = 0
 1041              		@ frame_needed = 0, uses_anonymous_args = 0
 1042              		@ link register save eliminated.
 1043              	.LVL108:
 452:libcanard/drivers/stm32/canard_stm32.c ****     // Note that num_filter_configs = 0 is a valid configuration, which rejects all frames.
 453:libcanard/drivers/stm32/canard_stm32.c ****     if ((filter_configs == NULL) ||
 1044              		.loc 1 453 0
 1045 0000 0028     		cmp	r0, #0
 1046 0002 40D0     		beq	.L108
 451:libcanard/drivers/stm32/canard_stm32.c ****     // Note that num_filter_configs = 0 is a valid configuration, which rejects all frames.
ARM GAS  /tmp/ccmkeNKF.s 			page 28


 1047              		.loc 1 451 0 discriminator 1
 1048 0004 70B4     		push	{r4, r5, r6}
 1049              	.LCFI14:
 1050              		.cfi_def_cfa_offset 12
 1051              		.cfi_offset 4, -12
 1052              		.cfi_offset 5, -8
 1053              		.cfi_offset 6, -4
 1054 0006 0646     		mov	r6, r0
 1055              		.loc 1 453 0 discriminator 1
 1056 0008 0E29     		cmp	r1, #14
 1057 000a 3FD8     		bhi	.L109
 454:libcanard/drivers/stm32/canard_stm32.c ****         (num_filter_configs > CANARD_STM32_NUM_ACCEPTANCE_FILTERS))
 455:libcanard/drivers/stm32/canard_stm32.c ****     {
 456:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_ERROR_INVALID_ARGUMENT;
 457:libcanard/drivers/stm32/canard_stm32.c ****     }
 458:libcanard/drivers/stm32/canard_stm32.c **** 
 459:libcanard/drivers/stm32/canard_stm32.c ****     /*
 460:libcanard/drivers/stm32/canard_stm32.c ****      * First we disable all filters. This may cause momentary RX frame losses, but the application
 461:libcanard/drivers/stm32/canard_stm32.c ****      * should be able to tolerate that.
 462:libcanard/drivers/stm32/canard_stm32.c ****      */
 463:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FA1R = 0;
 1058              		.loc 1 463 0
 1059 000c 0023     		movs	r3, #0
 1060 000e 214A     		ldr	r2, .L116
 1061 0010 C2F81C32 		str	r3, [r2, #540]
 1062              	.LVL109:
 1063              	.LBB20:
 464:libcanard/drivers/stm32/canard_stm32.c **** 
 465:libcanard/drivers/stm32/canard_stm32.c ****     /*
 466:libcanard/drivers/stm32/canard_stm32.c ****      * Having filters disabled we can update the configuration.
 467:libcanard/drivers/stm32/canard_stm32.c ****      * Register mapping: FR1 - ID, FR2 - Mask
 468:libcanard/drivers/stm32/canard_stm32.c ****      */
 469:libcanard/drivers/stm32/canard_stm32.c ****     for (uint8_t i = 0; i < num_filter_configs; i++)
 1064              		.loc 1 469 0
 1065 0014 16E0     		b	.L100
 1066              	.LVL110:
 1067              	.L102:
 1068              	.LBB21:
 470:libcanard/drivers/stm32/canard_stm32.c ****     {
 471:libcanard/drivers/stm32/canard_stm32.c ****         /*
 472:libcanard/drivers/stm32/canard_stm32.c ****          * Converting the ID and the Mask into the representation that can be chewed by the hardwar
 473:libcanard/drivers/stm32/canard_stm32.c ****          * If Mask asks us to accept both STDID and EXTID, we need to use EXT mode on the filter,
 474:libcanard/drivers/stm32/canard_stm32.c ****          * otherwise it will reject all EXTID frames. This logic is not documented in the RM.
 475:libcanard/drivers/stm32/canard_stm32.c ****          *
 476:libcanard/drivers/stm32/canard_stm32.c ****          * The logic of the hardware acceptance filters can be described as follows:
 477:libcanard/drivers/stm32/canard_stm32.c ****          *
 478:libcanard/drivers/stm32/canard_stm32.c ****          *  accepted = (received_id & filter_mask) == (filter_id & filter_mask)
 479:libcanard/drivers/stm32/canard_stm32.c ****          *
 480:libcanard/drivers/stm32/canard_stm32.c ****          * Where:
 481:libcanard/drivers/stm32/canard_stm32.c ****          *  - accepted      - if true, the frame will be accepted by the filter.
 482:libcanard/drivers/stm32/canard_stm32.c ****          *  - received_id   - the CAN ID of the received frame, either 11-bit or 29-bit, with exten
 483:libcanard/drivers/stm32/canard_stm32.c ****          *                    marking extended frames, error frames, etc.
 484:libcanard/drivers/stm32/canard_stm32.c ****          *  - filter_id     - the value of the filter ID register.
 485:libcanard/drivers/stm32/canard_stm32.c ****          *  - filter_mask   - the value of the filter mask register.
 486:libcanard/drivers/stm32/canard_stm32.c ****          *
 487:libcanard/drivers/stm32/canard_stm32.c ****          * There are special bits that are not members of the CAN ID field:
 488:libcanard/drivers/stm32/canard_stm32.c ****          *  - EFF - set for extended frames (29-bit), cleared for standard frames (11-bit)
ARM GAS  /tmp/ccmkeNKF.s 			page 29


 489:libcanard/drivers/stm32/canard_stm32.c ****          *  - RTR - like above, indicates Remote Transmission Request frames.
 490:libcanard/drivers/stm32/canard_stm32.c ****          *
 491:libcanard/drivers/stm32/canard_stm32.c ****          * The following truth table summarizes the logic (where: FM - filter mask, FID - filter ID
 492:libcanard/drivers/stm32/canard_stm32.c ****          * frame ID, A - true if accepted, X - any state):
 493:libcanard/drivers/stm32/canard_stm32.c ****          *
 494:libcanard/drivers/stm32/canard_stm32.c ****          *  FM  FID RID A
 495:libcanard/drivers/stm32/canard_stm32.c ****          *  0   X   X   1
 496:libcanard/drivers/stm32/canard_stm32.c ****          *  1   0   0   1
 497:libcanard/drivers/stm32/canard_stm32.c ****          *  1   1   0   0
 498:libcanard/drivers/stm32/canard_stm32.c ****          *  1   0   1   0
 499:libcanard/drivers/stm32/canard_stm32.c ****          *  1   1   1   1
 500:libcanard/drivers/stm32/canard_stm32.c ****          *
 501:libcanard/drivers/stm32/canard_stm32.c ****          * One would expect that for the purposes of hardware filtering, the special bits should be
 502:libcanard/drivers/stm32/canard_stm32.c ****          * in the same way as the real ID bits. However, this is not the case with bxCAN. The follo
 503:libcanard/drivers/stm32/canard_stm32.c ****          * table has been determined empirically (this behavior was not documented as of 2017):
 504:libcanard/drivers/stm32/canard_stm32.c ****          *
 505:libcanard/drivers/stm32/canard_stm32.c ****          *  FM  FID RID A
 506:libcanard/drivers/stm32/canard_stm32.c ****          *  0   0   0   1
 507:libcanard/drivers/stm32/canard_stm32.c ****          *  0   0   1   0       <-- frame rejected!
 508:libcanard/drivers/stm32/canard_stm32.c ****          *  0   1   X   1
 509:libcanard/drivers/stm32/canard_stm32.c ****          *  1   0   0   1
 510:libcanard/drivers/stm32/canard_stm32.c ****          *  1   1   0   0
 511:libcanard/drivers/stm32/canard_stm32.c ****          *  1   0   1   0
 512:libcanard/drivers/stm32/canard_stm32.c ****          *  1   1   1   1
 513:libcanard/drivers/stm32/canard_stm32.c ****          */
 514:libcanard/drivers/stm32/canard_stm32.c ****         uint32_t id   = 0;
 515:libcanard/drivers/stm32/canard_stm32.c ****         uint32_t mask = 0;
 516:libcanard/drivers/stm32/canard_stm32.c **** 
 517:libcanard/drivers/stm32/canard_stm32.c ****         const CanardSTM32AcceptanceFilterConfiguration* const cfg = filter_configs + i;
 518:libcanard/drivers/stm32/canard_stm32.c **** 
 519:libcanard/drivers/stm32/canard_stm32.c ****         if ((cfg->id & CANARD_CAN_FRAME_EFF) || !(cfg->mask & CANARD_CAN_FRAME_EFF))
 520:libcanard/drivers/stm32/canard_stm32.c ****         {
 521:libcanard/drivers/stm32/canard_stm32.c ****             id   = (cfg->id   & CANARD_CAN_EXT_ID_MASK) << 3U;
 522:libcanard/drivers/stm32/canard_stm32.c ****             mask = (cfg->mask & CANARD_CAN_EXT_ID_MASK) << 3U;
 523:libcanard/drivers/stm32/canard_stm32.c ****             id |= CANARD_STM32_CAN_RIR_IDE;
 524:libcanard/drivers/stm32/canard_stm32.c ****         }
 525:libcanard/drivers/stm32/canard_stm32.c ****         else
 526:libcanard/drivers/stm32/canard_stm32.c ****         {
 527:libcanard/drivers/stm32/canard_stm32.c ****             id   = (cfg->id   & CANARD_CAN_STD_ID_MASK) << 21U;
 1069              		.loc 1 527 0
 1070 0016 6005     		lsls	r0, r4, #21
 1071              	.LVL111:
 528:libcanard/drivers/stm32/canard_stm32.c ****             mask = (cfg->mask & CANARD_CAN_STD_ID_MASK) << 21U;
 1072              		.loc 1 528 0
 1073 0018 5205     		lsls	r2, r2, #21
 1074              	.LVL112:
 1075 001a 23E0     		b	.L103
 1076              	.L115:
 529:libcanard/drivers/stm32/canard_stm32.c ****         }
 530:libcanard/drivers/stm32/canard_stm32.c **** 
 531:libcanard/drivers/stm32/canard_stm32.c ****         if (cfg->id & CANARD_CAN_FRAME_RTR)
 532:libcanard/drivers/stm32/canard_stm32.c ****         {
 533:libcanard/drivers/stm32/canard_stm32.c ****             id |= CANARD_STM32_CAN_RIR_RTR;
 534:libcanard/drivers/stm32/canard_stm32.c ****         }
 535:libcanard/drivers/stm32/canard_stm32.c **** 
 536:libcanard/drivers/stm32/canard_stm32.c ****         if (cfg->mask & CANARD_CAN_FRAME_EFF)
 537:libcanard/drivers/stm32/canard_stm32.c ****         {
ARM GAS  /tmp/ccmkeNKF.s 			page 30


 538:libcanard/drivers/stm32/canard_stm32.c ****             mask |= CANARD_STM32_CAN_RIR_IDE;
 1077              		.loc 1 538 0
 1078 001c 42F00402 		orr	r2, r2, #4
 1079              	.LVL113:
 1080 0020 28E0     		b	.L105
 1081              	.L106:
 1082              	.LVL114:
 539:libcanard/drivers/stm32/canard_stm32.c ****         }
 540:libcanard/drivers/stm32/canard_stm32.c **** 
 541:libcanard/drivers/stm32/canard_stm32.c ****         if (cfg->mask & CANARD_CAN_FRAME_RTR)
 542:libcanard/drivers/stm32/canard_stm32.c ****         {
 543:libcanard/drivers/stm32/canard_stm32.c ****             mask |= CANARD_STM32_CAN_RIR_RTR;
 544:libcanard/drivers/stm32/canard_stm32.c ****         }
 545:libcanard/drivers/stm32/canard_stm32.c **** 
 546:libcanard/drivers/stm32/canard_stm32.c ****         /*
 547:libcanard/drivers/stm32/canard_stm32.c ****          * Applying the converted representation to the registers.
 548:libcanard/drivers/stm32/canard_stm32.c ****          */
 549:libcanard/drivers/stm32/canard_stm32.c ****         const uint8_t filter_index =
 550:libcanard/drivers/stm32/canard_stm32.c **** #if CANARD_STM32_USE_CAN2
 551:libcanard/drivers/stm32/canard_stm32.c ****             (uint8_t)(i + CANARD_STM32_NUM_ACCEPTANCE_FILTERS);
 552:libcanard/drivers/stm32/canard_stm32.c **** #else
 553:libcanard/drivers/stm32/canard_stm32.c ****             i;
 554:libcanard/drivers/stm32/canard_stm32.c **** #endif
 555:libcanard/drivers/stm32/canard_stm32.c ****         CANARD_STM32_CAN1->FilterRegister[filter_index].FR1 = id;
 1083              		.loc 1 555 0 discriminator 2
 1084 0022 1C4C     		ldr	r4, .L116
 1085 0024 03F14805 		add	r5, r3, #72
 1086              	.LVL115:
 1087 0028 44F83500 		str	r0, [r4, r5, lsl #3]
 556:libcanard/drivers/stm32/canard_stm32.c ****         CANARD_STM32_CAN1->FilterRegister[filter_index].FR2 = mask;
 1088              		.loc 1 556 0 discriminator 2
 1089 002c 04EBC505 		add	r5, r4, r5, lsl #3
 1090 0030 6A60     		str	r2, [r5, #4]
 557:libcanard/drivers/stm32/canard_stm32.c **** 
 558:libcanard/drivers/stm32/canard_stm32.c ****         CANARD_STM32_CAN1->FA1R |= 1U << filter_index;      // Enable
 1091              		.loc 1 558 0 discriminator 2
 1092 0032 D4F81C22 		ldr	r2, [r4, #540]
 1093              	.LVL116:
 1094 0036 0120     		movs	r0, #1
 1095              	.LVL117:
 1096 0038 9840     		lsls	r0, r0, r3
 1097 003a 0243     		orrs	r2, r2, r0
 1098 003c C4F81C22 		str	r2, [r4, #540]
 1099              	.LVL118:
 1100              	.LBE21:
 469:libcanard/drivers/stm32/canard_stm32.c ****     {
 1101              		.loc 1 469 0 discriminator 2
 1102 0040 0133     		adds	r3, r3, #1
 1103              	.LVL119:
 1104 0042 DBB2     		uxtb	r3, r3
 1105              	.LVL120:
 1106              	.L100:
 469:libcanard/drivers/stm32/canard_stm32.c ****     {
 1107              		.loc 1 469 0 is_stmt 0 discriminator 1
 1108 0044 8B42     		cmp	r3, r1
 1109 0046 1BD2     		bcs	.L114
 1110              	.LVL121:
ARM GAS  /tmp/ccmkeNKF.s 			page 31


 1111              	.LBB22:
 517:libcanard/drivers/stm32/canard_stm32.c **** 
 1112              		.loc 1 517 0 is_stmt 1
 1113 0048 06EBC305 		add	r5, r6, r3, lsl #3
 1114              	.LVL122:
 519:libcanard/drivers/stm32/canard_stm32.c ****         {
 1115              		.loc 1 519 0
 1116 004c 56F83340 		ldr	r4, [r6, r3, lsl #3]
 1117 0050 002C     		cmp	r4, #0
 1118 0052 02DB     		blt	.L101
 519:libcanard/drivers/stm32/canard_stm32.c ****         {
 1119              		.loc 1 519 0 is_stmt 0 discriminator 1
 1120 0054 6A68     		ldr	r2, [r5, #4]
 1121 0056 002A     		cmp	r2, #0
 1122 0058 DDDB     		blt	.L102
 1123              	.L101:
 521:libcanard/drivers/stm32/canard_stm32.c ****             mask = (cfg->mask & CANARD_CAN_EXT_ID_MASK) << 3U;
 1124              		.loc 1 521 0 is_stmt 1
 1125 005a E000     		lsls	r0, r4, #3
 1126              	.LVL123:
 522:libcanard/drivers/stm32/canard_stm32.c ****             id |= CANARD_STM32_CAN_RIR_IDE;
 1127              		.loc 1 522 0
 1128 005c 6A68     		ldr	r2, [r5, #4]
 1129 005e D200     		lsls	r2, r2, #3
 1130              	.LVL124:
 523:libcanard/drivers/stm32/canard_stm32.c ****         }
 1131              		.loc 1 523 0
 1132 0060 40F00400 		orr	r0, r0, #4
 1133              	.LVL125:
 1134              	.L103:
 531:libcanard/drivers/stm32/canard_stm32.c ****         {
 1135              		.loc 1 531 0
 1136 0064 14F0804F 		tst	r4, #1073741824
 1137 0068 01D0     		beq	.L104
 533:libcanard/drivers/stm32/canard_stm32.c ****         }
 1138              		.loc 1 533 0
 1139 006a 40F00200 		orr	r0, r0, #2
 1140              	.LVL126:
 1141              	.L104:
 536:libcanard/drivers/stm32/canard_stm32.c ****         {
 1142              		.loc 1 536 0
 1143 006e 6C68     		ldr	r4, [r5, #4]
 1144 0070 002C     		cmp	r4, #0
 1145 0072 D3DB     		blt	.L115
 1146              	.L105:
 541:libcanard/drivers/stm32/canard_stm32.c ****         {
 1147              		.loc 1 541 0
 1148 0074 14F0804F 		tst	r4, #1073741824
 1149 0078 D3D0     		beq	.L106
 543:libcanard/drivers/stm32/canard_stm32.c ****         }
 1150              		.loc 1 543 0
 1151 007a 42F00202 		orr	r2, r2, #2
 1152              	.LVL127:
 1153 007e D0E7     		b	.L106
 1154              	.LVL128:
 1155              	.L114:
 1156              	.LBE22:
ARM GAS  /tmp/ccmkeNKF.s 			page 32


 1157              	.LBE20:
 559:libcanard/drivers/stm32/canard_stm32.c ****     }
 560:libcanard/drivers/stm32/canard_stm32.c **** 
 561:libcanard/drivers/stm32/canard_stm32.c ****     return 0;
 1158              		.loc 1 561 0
 1159 0080 0020     		movs	r0, #0
 1160              	.LVL129:
 1161              	.L99:
 562:libcanard/drivers/stm32/canard_stm32.c **** }
 1162              		.loc 1 562 0
 1163 0082 70BC     		pop	{r4, r5, r6}
 1164              	.LCFI15:
 1165              		.cfi_restore 6
 1166              		.cfi_restore 5
 1167              		.cfi_restore 4
 1168              		.cfi_def_cfa_offset 0
 1169              	.LVL130:
 1170 0084 7047     		bx	lr
 1171              	.LVL131:
 1172              	.L108:
 456:libcanard/drivers/stm32/canard_stm32.c ****     }
 1173              		.loc 1 456 0
 1174 0086 6FF00100 		mvn	r0, #1
 1175              	.LVL132:
 1176 008a 7047     		bx	lr
 1177              	.LVL133:
 1178              	.L109:
 1179              	.LCFI16:
 1180              		.cfi_def_cfa_offset 12
 1181              		.cfi_offset 4, -12
 1182              		.cfi_offset 5, -8
 1183              		.cfi_offset 6, -4
 1184 008c 6FF00100 		mvn	r0, #1
 1185              	.LVL134:
 1186 0090 F7E7     		b	.L99
 1187              	.L117:
 1188 0092 00BF     		.align	2
 1189              	.L116:
 1190 0094 00640040 		.word	1073767424
 1191              		.cfi_endproc
 1192              	.LFE9:
 1194              		.section	.text.canardSTM32GetStats,"ax",%progbits
 1195              		.align	1
 1196              		.global	canardSTM32GetStats
 1197              		.syntax unified
 1198              		.thumb
 1199              		.thumb_func
 1200              		.fpu softvfp
 1202              	canardSTM32GetStats:
 1203              	.LFB10:
 563:libcanard/drivers/stm32/canard_stm32.c **** 
 564:libcanard/drivers/stm32/canard_stm32.c **** 
 565:libcanard/drivers/stm32/canard_stm32.c **** CanardSTM32Stats canardSTM32GetStats(void)
 566:libcanard/drivers/stm32/canard_stm32.c **** {
 1204              		.loc 1 566 0
 1205              		.cfi_startproc
 1206              		@ args = 0, pretend = 0, frame = 0
ARM GAS  /tmp/ccmkeNKF.s 			page 33


 1207              		@ frame_needed = 0, uses_anonymous_args = 0
 1208              		@ link register save eliminated.
 1209              	.LVL135:
 1210 0000 10B4     		push	{r4}
 1211              	.LCFI17:
 1212              		.cfi_def_cfa_offset 4
 1213              		.cfi_offset 4, -4
 1214 0002 0446     		mov	r4, r0
 567:libcanard/drivers/stm32/canard_stm32.c ****     return g_stats;
 1215              		.loc 1 567 0
 1216 0004 034B     		ldr	r3, .L120
 1217 0006 0FCB     		ldm	r3, {r0, r1, r2, r3}
 1218              	.LVL136:
 1219 0008 84E80F00 		stm	r4, {r0, r1, r2, r3}
 568:libcanard/drivers/stm32/canard_stm32.c **** }
 1220              		.loc 1 568 0
 1221 000c 2046     		mov	r0, r4
 1222 000e 10BC     		pop	{r4}
 1223              	.LCFI18:
 1224              		.cfi_restore 4
 1225              		.cfi_def_cfa_offset 0
 1226              	.LVL137:
 1227 0010 7047     		bx	lr
 1228              	.L121:
 1229 0012 00BF     		.align	2
 1230              	.L120:
 1231 0014 00000000 		.word	.LANCHOR0
 1232              		.cfi_endproc
 1233              	.LFE10:
 1235              		.section	.bss.g_abort_tx_on_error,"aw",%nobits
 1236              		.set	.LANCHOR1,. + 0
 1239              	g_abort_tx_on_error:
 1240 0000 00       		.space	1
 1241              		.section	.bss.g_stats,"aw",%nobits
 1242              		.align	3
 1243              		.set	.LANCHOR0,. + 0
 1246              	g_stats:
 1247 0000 00000000 		.space	16
 1247      00000000 
 1247      00000000 
 1247      00000000 
 1248              		.section	.rodata.RFxR.5211,"a",%progbits
 1249              		.align	2
 1250              		.set	.LANCHOR4,. + 0
 1253              	RFxR.5211:
 1254 0000 0C640040 		.word	1073767436
 1255 0004 10640040 		.word	1073767440
 1256              		.section	.rodata.__func__.5194,"a",%progbits
 1257              		.align	2
 1258              		.set	.LANCHOR2,. + 0
 1261              	__func__.5194:
 1262 0000 63616E61 		.ascii	"canardSTM32Init\000"
 1262      72645354 
 1262      4D333249 
 1262      6E697400 
 1263              		.section	.rodata.__func__.5206,"a",%progbits
 1264              		.align	2
ARM GAS  /tmp/ccmkeNKF.s 			page 34


 1265              		.set	.LANCHOR3,. + 0
 1268              	__func__.5206:
 1269 0000 63616E61 		.ascii	"canardSTM32Transmit\000"
 1269      72645354 
 1269      4D333254 
 1269      72616E73 
 1269      6D697400 
 1270              		.section	.rodata.canardSTM32Init.str1.4,"aMS",%progbits,1
 1271              		.align	2
 1272              	.LC0:
 1273 0000 30203D3D 		.ascii	"0 == ((volatile CanardSTM32CANType*)0x40006400U)->I"
 1273      20282876 
 1273      6F6C6174 
 1273      696C6520 
 1273      43616E61 
 1274 0033 455200   		.ascii	"ER\000"
 1275 0036 0000     		.space	2
 1276              	.LC1:
 1277 0038 6C696263 		.ascii	"libcanard/drivers/stm32/canard_stm32.c\000"
 1277      616E6172 
 1277      642F6472 
 1277      69766572 
 1277      732F7374 
 1278 005f 00       		.space	1
 1279              	.LC2:
 1280 0060 28282828 		.ascii	"((((volatile CanardSTM32CANType*)0x40006400U)->FMR "
 1280      766F6C61 
 1280      74696C65 
 1280      2043616E 
 1280      61726453 
 1281 0093 3E3E2038 		.ascii	">> 8U) & 0x3FU) == 14U\000"
 1281      55292026 
 1281      20307833 
 1281      46552920 
 1281      3D3D2031 
 1282              		.section	.rodata.canardSTM32Transmit.str1.4,"aMS",%progbits,1
 1283              		.align	2
 1284              	.LC3:
 1285 0000 21224341 		.ascii	"!\"CAN PRIO INV\"\000"
 1285      4E205052 
 1285      494F2049 
 1285      4E562200 
 1286              	.LC4:
 1287 0010 74785F6D 		.ascii	"tx_mailbox < 3\000"
 1287      61696C62 
 1287      6F78203C 
 1287      203300
 1288              		.text
 1289              	.Letext0:
 1290              		.file 2 "/usr/bin/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/machine/_default_types.
 1291              		.file 3 "/usr/bin/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/sys/_stdint.h"
 1292              		.file 4 "/usr/bin/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/stdint.h"
 1293              		.file 5 "libcanard/canard.h"
 1294              		.file 6 "/usr/bin/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/sys/lock.h"
 1295              		.file 7 "/usr/bin/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/sys/_types.h"
 1296              		.file 8 "/usr/bin/gcc-arm-none-eabi-6-2017-q2-update/lib/gcc/arm-none-eabi/6.3.1/include/stddef.h"
 1297              		.file 9 "/usr/bin/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/sys/reent.h"
ARM GAS  /tmp/ccmkeNKF.s 			page 35


 1298              		.file 10 "libcanard/drivers/stm32/canard_stm32.h"
 1299              		.file 11 "libcanard/drivers/stm32/_internal_bxcan.h"
 1300              		.file 12 "/usr/bin/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/sys/unistd.h"
 1301              		.file 13 "/usr/bin/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/assert.h"
ARM GAS  /tmp/ccmkeNKF.s 			page 36


DEFINED SYMBOLS
                            *ABS*:0000000000000000 canard_stm32.c
     /tmp/ccmkeNKF.s:16     .text.isFramePriorityHigher:0000000000000000 $t
     /tmp/ccmkeNKF.s:22     .text.isFramePriorityHigher:0000000000000000 isFramePriorityHigher
     /tmp/ccmkeNKF.s:135    .text.convertFrameIDCanardToRegister:0000000000000000 $t
     /tmp/ccmkeNKF.s:141    .text.convertFrameIDCanardToRegister:0000000000000000 convertFrameIDCanardToRegister
     /tmp/ccmkeNKF.s:176    .text.convertFrameIDRegisterToCanard:0000000000000000 $t
     /tmp/ccmkeNKF.s:182    .text.convertFrameIDRegisterToCanard:0000000000000000 convertFrameIDRegisterToCanard
     /tmp/ccmkeNKF.s:219    .text.waitMSRINAKBitStateChange:0000000000000000 $t
     /tmp/ccmkeNKF.s:225    .text.waitMSRINAKBitStateChange:0000000000000000 waitMSRINAKBitStateChange
     /tmp/ccmkeNKF.s:279    .text.processErrorStatus:0000000000000000 $t
     /tmp/ccmkeNKF.s:285    .text.processErrorStatus:0000000000000000 processErrorStatus
     /tmp/ccmkeNKF.s:329    .text.processErrorStatus:0000000000000038 $d
     /tmp/ccmkeNKF.s:337    .text.canardSTM32Init:0000000000000000 $t
     /tmp/ccmkeNKF.s:344    .text.canardSTM32Init:0000000000000000 canardSTM32Init
     /tmp/ccmkeNKF.s:634    .text.canardSTM32Init:00000000000001a8 $d
     /tmp/ccmkeNKF.s:646    .text.canardSTM32Transmit:0000000000000000 $t
     /tmp/ccmkeNKF.s:653    .text.canardSTM32Transmit:0000000000000000 canardSTM32Transmit
     /tmp/ccmkeNKF.s:874    .text.canardSTM32Transmit:00000000000000fc $d
     /tmp/ccmkeNKF.s:884    .text.canardSTM32Receive:0000000000000000 $t
     /tmp/ccmkeNKF.s:891    .text.canardSTM32Receive:0000000000000000 canardSTM32Receive
     /tmp/ccmkeNKF.s:1022   .text.canardSTM32Receive:000000000000008c $d
     /tmp/ccmkeNKF.s:1029   .text.canardSTM32ConfigureAcceptanceFilters:0000000000000000 $t
     /tmp/ccmkeNKF.s:1036   .text.canardSTM32ConfigureAcceptanceFilters:0000000000000000 canardSTM32ConfigureAcceptanceFilters
     /tmp/ccmkeNKF.s:1190   .text.canardSTM32ConfigureAcceptanceFilters:0000000000000094 $d
     /tmp/ccmkeNKF.s:1195   .text.canardSTM32GetStats:0000000000000000 $t
     /tmp/ccmkeNKF.s:1202   .text.canardSTM32GetStats:0000000000000000 canardSTM32GetStats
     /tmp/ccmkeNKF.s:1231   .text.canardSTM32GetStats:0000000000000014 $d
     /tmp/ccmkeNKF.s:1239   .bss.g_abort_tx_on_error:0000000000000000 g_abort_tx_on_error
     /tmp/ccmkeNKF.s:1240   .bss.g_abort_tx_on_error:0000000000000000 $d
     /tmp/ccmkeNKF.s:1242   .bss.g_stats:0000000000000000 $d
     /tmp/ccmkeNKF.s:1246   .bss.g_stats:0000000000000000 g_stats
     /tmp/ccmkeNKF.s:1249   .rodata.RFxR.5211:0000000000000000 $d
     /tmp/ccmkeNKF.s:1253   .rodata.RFxR.5211:0000000000000000 RFxR.5211
     /tmp/ccmkeNKF.s:1257   .rodata.__func__.5194:0000000000000000 $d
     /tmp/ccmkeNKF.s:1261   .rodata.__func__.5194:0000000000000000 __func__.5194
     /tmp/ccmkeNKF.s:1264   .rodata.__func__.5206:0000000000000000 $d
     /tmp/ccmkeNKF.s:1268   .rodata.__func__.5206:0000000000000000 __func__.5206
     /tmp/ccmkeNKF.s:1271   .rodata.canardSTM32Init.str1.4:0000000000000000 $d
     /tmp/ccmkeNKF.s:1283   .rodata.canardSTM32Transmit.str1.4:0000000000000000 $d
                     .debug_frame:0000000000000010 $d

UNDEFINED SYMBOLS
__assert_func
